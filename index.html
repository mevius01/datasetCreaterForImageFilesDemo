<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ç”¨ãƒ‡ãƒ¼ã‚¿ZIPä½œæˆãƒ„ãƒ¼ãƒ«</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        /* å…¨ä½“ã®ãƒ•ã‚©ãƒ³ãƒˆã€ãƒãƒ¼ã‚¸ãƒ³ã€èƒŒæ™¯è‰²ã€æ–‡å­—è‰²ã‚’è¨­å®šã—ã¾ã™ */
        body {
            font-family: 'Inter', sans-serif; /* ãƒ•ã‚©ãƒ³ãƒˆã‚’Interã«å¤‰æ›´ */
            margin: 20px;
            background-color: #282c34; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®èƒŒæ™¯è‰² */
            color: #e0e0e0; /* æ˜ã‚‹ã„æ–‡å­—è‰² */
            line-height: 1.6;
        }
        /* ã‚³ãƒ³ãƒ†ãƒŠã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨­å®šã—ã€ä¸­å¤®ã«é…ç½®ã€ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã€èƒŒæ™¯è‰²ã€è§’ä¸¸ã€å½±ã‚’è¿½åŠ ã—ã¾ã™ */
        .container {
            max-width: 1200px; /* å¹…ã‚’ã•ã‚‰ã«åºƒã’ã‚‹ */
            margin: 0 auto;
            padding: 30px;
            background-color: #3a3f4a; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®ã‚³ãƒ³ãƒ†ãƒŠèƒŒæ™¯è‰² */
            border-radius: 12px; /* è§’ä¸¸ã‚’å¼·èª¿ */
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3); /* å½±ã‚’å¼·èª¿ */
        }
        /* è¦‹å‡ºã—ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨­å®šã—ã€è‰²ã€ä¸­å¤®æƒãˆã€ä¸‹ãƒãƒ¼ã‚¸ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ */
        h1, h2 {
            color: #ffffff; /* æ˜ã‚‹ã„è¦‹å‡ºã—è‰² */
            text-align: center;
            margin-bottom: 25px;
            font-weight: 600; /* å°‘ã—å¤ªã */
        }
        /* å…¥åŠ›ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆãƒ©ãƒ™ãƒ«ã¨å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã‚»ãƒƒãƒˆï¼‰ã®ä¸‹ãƒãƒ¼ã‚¸ãƒ³ã‚’è¨­å®šã—ã¾ã™ */
        .input-group {
            margin-bottom: 20px;
        }
        /* ãƒ©ãƒ™ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨­å®šã—ã€ãƒ–ãƒ­ãƒƒã‚¯è¡¨ç¤ºã€ä¸‹ãƒãƒ¼ã‚¸ãƒ³ã€å¤ªå­—ã€è‰²ã‚’è¿½åŠ ã—ã¾ã™ */
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #bbbbbb; /* æ˜ã‚‹ã„ãƒ©ãƒ™ãƒ«è‰² */
        }
        /* ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨­å®šã—ã€ãƒ–ãƒ­ãƒƒã‚¯è¡¨ç¤ºã€ä¸­å¤®ãƒãƒ¼ã‚¸ãƒ³ã€ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã€ç ´ç·šãƒœãƒ¼ãƒ€ãƒ¼ã€è§’ä¸¸ã€èƒŒæ™¯è‰²ã€ã‚«ãƒ¼ã‚½ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ */
        input[type="file"] {
            display: block;
            margin: 10px auto;
            padding: 10px;
            border: 2px dashed #6a9acb; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆã‚ã›ãŸãƒœãƒ¼ãƒ€ãƒ¼è‰² */
            border-radius: 8px;
            width: fit-content;
            background-color: #4a4f59; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®èƒŒæ™¯è‰² */
            color: #e0e0e0; /* æ˜ã‚‹ã„æ–‡å­—è‰² */
            cursor: pointer;
            transition: border-color 0.3s ease;
        }
        input[type="file"]:hover {
            border-color: #8fb8e6; /* ãƒ›ãƒãƒ¼æ™‚ã®ãƒœãƒ¼ãƒ€ãƒ¼è‰² */
        }
        /* ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨­å®šã—ã€ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã€ãƒœãƒ¼ãƒ€ãƒ¼ãªã—ã€è§’ä¸¸ã€èƒŒæ™¯è‰²ã€æ–‡å­—è‰²ã€ã‚«ãƒ¼ã‚½ãƒ«ã€ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ */
        input[type="file"]::file-selector-button {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            background-color: #61afef; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆã‚ã›ãŸãƒœã‚¿ãƒ³è‰² */
            color: white;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        input[type="file"]::file-selector-button:hover {
            background-color: #529edb;
        }
        /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸Šãƒãƒ¼ã‚¸ãƒ³ã€ä¸Šãƒœãƒ¼ãƒ€ãƒ¼ã€ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã€ä¸­å¤®æƒãˆã‚’è¨­å®šã—ã¾ã™ */
        .preview {
            margin-top: 30px;
            border-top: 1px solid #555; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆã‚ã›ãŸãƒœãƒ¼ãƒ€ãƒ¼è‰² */
            padding-top: 20px;
            text-align: center;
        }
        /* ãƒ•ã‚©ãƒ«ãƒ€æŒ‡å®šã®èª¬æ˜ãƒ†ã‚­ã‚¹ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .folder-instruction {
            font-size: 0.95em;
            color: #bbbbbb; /* æ˜ã‚‹ã„æ–‡å­—è‰² */
            margin-bottom: 15px;
            text-align: left; /* å·¦å¯„ã› */
            padding: 0 10px; /* å·¦å³ã«å°‘ã—ãƒ‘ãƒ‡ã‚£ãƒ³ã‚° */
        }
        .folder-instruction strong {
            color: #ffffff; /* æ˜ã‚‹ã„å¼·èª¿è‰² */
        }

        /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’å·¦å³ã«åˆ†å‰² */
        .main-content {
            display: flex;
            gap: 20px;
            margin-top: 20px;
        }
        .left-panel {
            flex: 1; /* å·¦ãƒ‘ãƒãƒ«ã¯æ®‹ã‚Šã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’åŸ‹ã‚ã‚‹ */
            min-width: 300px; /* æœ€å°å¹…ã‚’è¨­å®š */
        }
        .right-panel {
            flex: 2; /* å³ãƒ‘ãƒãƒ«ã¯å·¦ãƒ‘ãƒãƒ«ã®2å€ã®å¹… */
            min-width: 500px; /* æœ€å°å¹…ã‚’è¨­å®š */
            background-color: #3a3f4a;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        /* ç”»åƒãƒªã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒŠã®ã‚¹ã‚¿ã‚¤ãƒ« */
        #image-list-container {
            display: flex;
            flex-direction: column; /* ç¸¦ã«ä¸¦ã¹ã‚‹ */
            gap: 15px;
            margin-top: 20px;
            max-height: 500px; /* é«˜ã•ã‚’åˆ¶é™ã—ã¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã«ã™ã‚‹ */
            overflow-y: auto; /* ç¸¦æ–¹å‘ã®ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æœ‰åŠ¹ã«ã™ã‚‹ */
            padding-right: 10px; /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®ãŸã‚ã®ã‚¹ãƒšãƒ¼ã‚¹ */
        }
        /* å„ç”»åƒã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .image-item {
            display: flex;
            align-items: flex-start; /* ä¸Šæƒãˆ */
            gap: 15px;
            padding: 10px;
            border: 1px solid #555; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆã‚ã›ãŸãƒœãƒ¼ãƒ€ãƒ¼è‰² */
            border-radius: 8px;
            background-color: #4a4f59; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®èƒŒæ™¯è‰² */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .image-item img {
            width: 60px; /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»åƒã®ã‚µã‚¤ã‚ºã‚’å°ã•ã */
            height: 60px;
            object-fit: cover; /* ç”»åƒãŒãƒœãƒƒã‚¯ã‚¹ã‚’åŸ‹ã‚ã‚‹ã‚ˆã†ã« */
            border-radius: 4px;
            flex-shrink: 0; /* ç¸®ã¾ãªã„ã‚ˆã†ã« */
        }
        .image-item .file-details {
            flex-grow: 1; /* æ®‹ã‚Šã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’åŸ‹ã‚ã‚‹ */
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .image-item .file-details p {
            margin: 0;
            font-size: 0.9em;
            color: #e0e0e0; /* æ˜ã‚‹ã„æ–‡å­—è‰² */
        }
        .image-item .input-row {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap; /* å°ã•ã„ç”»é¢ã§æŠ˜ã‚Šè¿”ã™ */
        }
        .image-item .input-row label {
            font-size: 0.85em;
            font-weight: bold;
            color: #bbbbbb;
            flex-shrink: 0; /* ç¸®ã¾ãªã„ã‚ˆã†ã« */
        }
        .image-item .input-row input[type="text"] {
            flex-grow: 1; /* æ®‹ã‚Šã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’åŸ‹ã‚ã‚‹ */
            min-width: 150px; /* æœ€å°å¹… */
            padding: 8px;
            border: 1px solid #777;
            border-radius: 5px;
            font-size: 0.9em;
            box-sizing: border-box;
            background-color: #3a3f4a; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰èƒŒæ™¯è‰² */
            color: #e0e0e0; /* æ˜ã‚‹ã„æ–‡å­—è‰² */
        }
        .image-item .delete-btn {
            background-color: #e06c75; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆã‚ã›ãŸèµ¤è‰² */
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-size: 0.9em;
            flex-shrink: 0; /* ç¸®ã¾ãªã„ã‚ˆã†ã« */
        }
        .image-item .delete-btn:hover {
            background-color: #d15a63;
        }

        /* ä¸€æ‹¬ãƒ•ã‚©ãƒ«ãƒ€æŒ‡å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .bulk-folder-section {
            padding: 15px;
            background-color: #4a4f59;
            border-radius: 8px;
            border: 1px solid #555;
            margin-bottom: 20px;
        }
        .bulk-folder-section .input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 10px; /* èª¬æ˜ãƒ†ã‚­ã‚¹ãƒˆã¨ã®é–“ã«ãƒãƒ¼ã‚¸ãƒ³ */
        }
        .bulk-folder-section .input-group input {
            flex-grow: 1;
            padding: 8px;
            border: 1px solid #777;
            border-radius: 5px;
            background-color: #3a3f4a;
            color: #e0e0e0;
        }
        .bulk-folder-section .input-group button {
            padding: 8px 15px;
            background-color: #61afef;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-size: 0.9em;
            margin: 0; /* è¦ªã®buttonã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä¸Šæ›¸ã */
            box-shadow: none;
        }
        .bulk-folder-section .input-group button:hover {
            background-color: #529edb;
            transform: none;
        }
        .bulk-folder-section .select-all-checkbox {
            display: flex;
            align-items: center;
            margin-top: 10px;
            font-size: 0.9em;
            color: #bbbbbb;
        }
        .bulk-folder-section .select-all-checkbox input[type="checkbox"] {
            margin-right: 8px;
            accent-color: #98c379;
        }


        /* ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é …ç›®è¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .metadata-column-config {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #555;
        }
        .metadata-column-config .add-column-input {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        .metadata-column-config .add-column-input input {
            flex-grow: 1;
            padding: 8px;
            border: 1px solid #777;
            border-radius: 5px;
            background-color: #3a3f4a;
            color: #e0e0e0;
        }
        .metadata-column-config .add-column-input button {
            padding: 8px 15px;
            background-color: #61afef;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            font-size: 0.9em;
            margin: 0; /* è¦ªã®buttonã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä¸Šæ›¸ã */
            box-shadow: none;
        }
        .metadata-column-config .add-column-input button:hover {
            background-color: #529edb;
            transform: none;
        }
        .metadata-column-config .current-columns {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .metadata-column-config .column-tag {
            background-color: #4a4f59;
            color: #e0e0e0;
            padding: 6px 10px;
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85em;
        }
        .metadata-column-config .column-tag .remove-column-btn {
            background: none;
            border: none;
            color: #e06c75;
            font-weight: bold;
            cursor: pointer;
            padding: 0 3px;
            font-size: 1.1em;
            line-height: 1;
            transition: color 0.3s ease;
        }
        .metadata-column-config .column-tag .remove-column-btn:hover {
            color: #d15a63;
        }


        /* ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ãƒ†ãƒ¼ãƒ–ãƒ« */
        .metadata-table-container {
            max-height: 400px; /* é«˜ã•ã‚’åˆ¶é™ã—ã¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã« */
            overflow-x: auto; /* æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æœ‰åŠ¹ã« */
            overflow-y: auto; /* ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚‚æœ‰åŠ¹ã« */
            border: 1px solid #555;
            border-radius: 8px;
            background-color: #3a3f4a;
            margin-top: 20px;
        }
        #metadata-table {
            width: 100%;
            border-collapse: collapse; /* ã‚»ãƒ«ã®å¢ƒç•Œç·šã‚’çµåˆ */
            table-layout: fixed; /* ã‚«ãƒ©ãƒ å¹…ã‚’å›ºå®š */
        }
        #metadata-table th, #metadata-table td {
            border: 1px solid #555;
            padding: 8px 12px;
            text-align: left;
            white-space: nowrap; /* ãƒ†ã‚­ã‚¹ãƒˆã®æŠ˜ã‚Šè¿”ã—ã‚’é˜²æ­¢ */
            overflow: hidden;
            text-overflow: ellipsis; /* ã¯ã¿å‡ºã—ãŸãƒ†ã‚­ã‚¹ãƒˆã‚’çœç•¥ */
            font-size: 0.9em;
            color: #e0e0e0;
        }
        #metadata-table th {
            background-color: #4a4f59;
            color: #ffffff;
            font-weight: bold;
            position: sticky; /* ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å›ºå®š */
            top: 0;
            z-index: 10;
        }
        #metadata-table td {
            background-color: #3a3f4a;
        }
        #metadata-table td input[type="text"] {
            width: calc(100% - 16px); /* paddingã‚’è€ƒæ…® */
            padding: 6px 8px;
            border: 1px solid #777;
            border-radius: 4px;
            background-color: #282c34; /* å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®èƒŒæ™¯è‰²ã‚’ã•ã‚‰ã«æš—ã */
            color: #e0e0e0;
            box-sizing: border-box;
        }
        #metadata-table td.fixed-column {
            background-color: #4a4f59; /* å›ºå®šåˆ—ã®èƒŒæ™¯è‰²ã‚’å°‘ã—å¤‰ãˆã‚‹ */
            font-weight: bold;
            color: #ffffff;
        }

        /* ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .license-settings {
            margin-top: 30px;
            padding: 20px;
            background-color: #3a3f4a;
            border-radius: 8px;
            border: 1px solid #555;
        }
        .license-settings .input-group {
            display: flex;
            flex-direction: column;
            margin-bottom: 15px;
        }
        .license-settings .input-group label {
            margin-bottom: 5px;
        }
        .license-settings select, .license-settings input[type="text"], .license-settings textarea, .license-settings input[type="date"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #777;
            border-radius: 5px;
            background-color: #282c34;
            color: #e0e0e0;
            box-sizing: border-box;
            font-size: 0.9em;
        }
        .license-settings textarea {
            min-height: 150px;
            resize: vertical; /* ç¸¦æ–¹å‘ã®ã¿ãƒªã‚µã‚¤ã‚ºå¯èƒ½ */
        }
        .license-settings select {
            appearance: none; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³çŸ¢å°ã‚’éè¡¨ç¤º */
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23e0e0e0%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13%205.1L146.2%20202.7%2018.5%2074.5a17.6%2017.6%200%200%200-25.1%2024.5l130.4%20127.9c6.8%206.7%2017.7%206.7%2024.5%200l130.4-127.9a17.6%2017.6%200%200%200-12.9-29.6z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 12px;
            padding-right: 30px; /* çŸ¢å°ã®ãŸã‚ã®ã‚¹ãƒšãƒ¼ã‚¹ */
        }
        .license-settings select:focus, .license-settings input[type="text"]:focus, .license-settings textarea:focus, .license-settings input[type="date"]:focus {
            outline: none;
            border-color: #61afef;
            box-shadow: 0 0 0 2px rgba(97, 175, 239, 0.5);
        }
        .license-settings .permission-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #555;
        }
        .license-settings .permission-options h3 {
            color: #ffffff;
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        .license-settings .permission-options h4 {
            color: #bbbbbb;
            margin-top: 15px;
            margin-bottom: 5px;
            font-size: 1em;
            border-bottom: 1px dashed #666;
            padding-bottom: 5px;
        }
        .license-settings .permission-option {
            display: flex;
            align-items: flex-start; /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã¨ãƒ†ã‚­ã‚¹ãƒˆã®å…ˆé ­ã‚’æƒãˆã‚‹ */
            font-size: 0.9em;
            color: #e0e0e0;
        }
        .license-settings .permission-option input[type="checkbox"] {
            margin-right: 10px;
            margin-top: 4px; /* ãƒ†ã‚­ã‚¹ãƒˆã®ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã«åˆã‚ã›ã‚‹ */
            flex-shrink: 0; /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãŒç¸®ã¾ãªã„ã‚ˆã†ã« */
            accent-color: #98c379;
            transform: scale(1.1); /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’å°‘ã—å¤§ãã */
        }
        .license-settings .permission-option label {
            margin-bottom: 0; /* è¦ªã®labelã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä¸Šæ›¸ã */
            font-weight: normal;
            display: inline-block;
            flex-grow: 1; /* ãƒ†ã‚­ã‚¹ãƒˆãŒæ®‹ã‚Šã®ã‚¹ãƒšãƒ¼ã‚¹ã‚’åŸ‹ã‚ã‚‹ã‚ˆã†ã« */
        }
        .license-settings .permission-option .sub-option {
            margin-left: 30px;
            font-size: 0.85em;
            color: #bbbbbb;
        }
        .license-settings .date-inputs {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        .license-settings .date-inputs input[type="date"] {
            flex: 1;
        }
        .license-settings .no-duration-checkbox {
            display: flex;
            align-items: center;
            margin-top: 5px;
            font-size: 0.9em;
            color: #bbbbbb;
        }
        .license-settings .no-duration-checkbox input[type="checkbox"] {
            margin-right: 8px;
            accent-color: #98c379;
        }


        /* æƒ…å ±è§£æãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã®é¸æŠ */
        .metadata-format-selection {
            margin-top: 20px;
            text-align: center;
            padding: 15px;
            background-color: #3a3f4a;
            border-radius: 8px;
            border: 1px solid #555;
        }
        .metadata-format-selection label {
            margin-right: 15px;
            font-weight: bold;
            color: #bbbbbb;
            cursor: pointer;
        }
        .metadata-format-selection input[type="radio"] {
            margin-right: 5px;
            accent-color: #61afef; /* ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®è‰² */
        }

        /* ZIPå†…å®¹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ */
        .zip-preview {
            margin-top: 30px;
            border-top: 1px solid #555; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆã‚ã›ãŸãƒœãƒ¼ãƒ€ãƒ¼è‰² */
            padding-top: 20px;
        }
        #zip-content-preview {
            list-style: none; /* ãƒªã‚¹ãƒˆã®ç‚¹ã‚’å‰Šé™¤ */
            padding: 0;
            text-align: left;
            max-height: 250px; /* é«˜ã•ã‚’åˆ¶é™ã—ã¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å¯èƒ½ã«ã™ã‚‹ */
            overflow-y: auto;
            border: 1px solid #555; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆã‚ã›ãŸãƒœãƒ¼ãƒ€ãƒ¼è‰² */
            border-radius: 8px;
            padding: 10px;
            background-color: #3a3f4a; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®èƒŒæ™¯è‰² */
        }
        #zip-content-preview li {
            padding: 5px 0;
            border-bottom: 1px dashed #666; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆã‚ã›ãŸç‚¹ç·šãƒœãƒ¼ãƒ€ãƒ¼ */
            font-size: 0.9em;
            color: #e0e0e0; /* æ˜ã‚‹ã„æ–‡å­—è‰² */
            word-break: break-all; /* é•·ã„ãƒ‘ã‚¹ã‚’æŠ˜ã‚Šè¿”ã™ */
        }
        #zip-content-preview li:last-child {
            border-bottom: none;
        }
        #zip-content-preview li::before {
            content: 'ğŸ“ '; /* ãƒ•ã‚©ãƒ«ãƒ€ã‚¢ã‚¤ã‚³ãƒ³ */
            margin-right: 5px;
            color: #f7d046; /* é»„è‰²ã„ãƒ•ã‚©ãƒ«ãƒ€ã‚¢ã‚¤ã‚³ãƒ³ */
        }
        #zip-content-preview li.metadata-file::before {
            content: 'ğŸ“„ '; /* ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¤ã‚³ãƒ³ */
            margin-right: 5px;
            color: #61afef; /* é’ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¤ã‚³ãƒ³ */
        }
        #zip-content-preview li.license-file::before {
            content: 'ğŸ“œ '; /* å·»ç‰©ã‚¢ã‚¤ã‚³ãƒ³ */
            margin-right: 5px;
            color: #e6b450; /* èŒ¶è‰²ã£ã½ã„å·»ç‰©ã‚¢ã‚¤ã‚³ãƒ³ */
        }

        /* æ³¨æ„äº‹é …ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .notes-section {
            margin-top: 40px;
            padding: 25px;
            background-color: #2e323a; /* ã‚ˆã‚Šæš—ã„èƒŒæ™¯è‰² */
            border-radius: 10px;
            border: 1px solid #444;
            color: #bbbbbb;
            font-size: 0.9em;
        }
        .notes-section h2 {
            color: #ffffff;
            margin-top: 0;
            margin-bottom: 15px;
            text-align: left;
        }
        .notes-section ul {
            list-style: disc;
            margin-left: 20px;
            padding-left: 0;
        }
        .notes-section li {
            margin-bottom: 10px;
        }
        .notes-section strong {
            color: #e0e0e0;
        }


        /* ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨­å®šã—ã€ãƒ–ãƒ­ãƒƒã‚¯è¡¨ç¤ºã€ä¸­å¤®ãƒãƒ¼ã‚¸ãƒ³ã€ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã€ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã€èƒŒæ™¯è‰²ã€æ–‡å­—è‰²ã€ãƒœãƒ¼ãƒ€ãƒ¼ãªã—ã€è§’ä¸¸ã€ã‚«ãƒ¼ã‚½ãƒ«ã€ãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³ã€å½±ã‚’è¿½åŠ ã—ã¾ã™ */
        button {
            display: block;
            margin: 30px auto 10px;
            padding: 12px 25px;
            font-size: 1.1em;
            background-color: #98c379; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆã‚ã›ãŸç·‘è‰² */
            color: #282c34; /* æš—ã„æ–‡å­—è‰² */
            border: none;
            border-radius: 7px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        /* ãƒœã‚¿ãƒ³ã®ãƒ›ãƒãƒ¼æ™‚ã®èƒŒæ™¯è‰²ã¨å¤‰å½¢ã‚’è¨­å®šã—ã¾ã™ */
        button:hover {
            background-color: #8ab86f;
            transform: translateY(-2px);
        }
        /* ç„¡åŠ¹åŒ–ã•ã‚ŒãŸãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨­å®šã—ã€èƒŒæ™¯è‰²ã€ã‚«ãƒ¼ã‚½ãƒ«ã€å¤‰å½¢ã€å½±ã‚’ç„¡åŠ¹ã«ã—ã¾ã™ */
        button:disabled {
            background-color: #666666; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®ç„¡åŠ¹åŒ–è‰² */
            color: #aaaaaa;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨­å®šã—ã€ä¸­å¤®æƒãˆã€ä¸Šãƒãƒ¼ã‚¸ãƒ³ã€å¤ªå­—ã€è‰²ã‚’è¿½åŠ ã—ã¾ã™ */
        .message {
            text-align: center;
            margin-top: 20px;
            font-weight: bold;
            color: #bbbbbb; /* æ˜ã‚‹ã„æ–‡å­—è‰² */
        }
        /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ”ãƒŠãƒ¼ã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è¨­å®šã—ã€ãƒœãƒ¼ãƒ€ãƒ¼ã€è§’ä¸¸ã€å¹…ã€é«˜ã•ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã€åˆæœŸéè¡¨ç¤ºã€ä¸­å¤®ãƒãƒ¼ã‚¸ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ */
        .loading-spinner {
            border: 4px solid #4a4f59; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®ã‚¹ãƒ”ãƒŠãƒ¼èƒŒæ™¯è‰² */
            border-top: 4px solid #61afef; /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã®ã‚¹ãƒ”ãƒŠãƒ¼è‰² */
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            display: none; /* åˆæœŸçŠ¶æ…‹ã§ã¯éè¡¨ç¤º */
            margin: 20px auto;
        }
        /* ã‚¹ãƒ”ãƒŠãƒ¼ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®šç¾©ã—ã¾ã™ */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column; /* ç¸¦ä¸¦ã³ã«å¤‰æ›´ */
            }
            .left-panel, .right-panel {
                min-width: unset; /* æœ€å°å¹…ã‚’ãƒªã‚»ãƒƒãƒˆ */
                width: 100%; /* å…¨å¹…ã«ã™ã‚‹ */
            }
            .image-item .input-row {
                flex-direction: column;
                align-items: flex-start;
            }
            .image-item .input-row label {
                margin-bottom: 5px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>AIãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ç”¨ãƒ‡ãƒ¼ã‚¿ZIPä½œæˆãƒ„ãƒ¼ãƒ«</h1>
        <p>è¤‡æ•°ã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã€ãã‚Œãã‚Œã«ZIPãƒ•ã‚¡ã‚¤ãƒ«å†…ã®ä¿å­˜ãƒ‘ã‚¹ã¨è¿½åŠ æƒ…å ±ã‚’æŒ‡å®šã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚</p>

        <div class="input-group">
            <label for="imageInput">ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ:</label>
            <input type="file" id="imageInput" accept="image/*" multiple>
        </div>

        <div class="main-content">
            <div class="left-panel">
                <div class="bulk-folder-section">
                    <h2>ä¸€æ‹¬ãƒ•ã‚©ãƒ«ãƒ€æŒ‡å®š</h2>
                    <div class="input-group">
                        <input type="text" id="bulkFolderPathInput" placeholder="ä¾‹: my_dataset/images">
                        <button id="applyBulkFolderBtn">é©ç”¨</button>
                    </div>
                    <small style="color: #bbbbbb;">ãƒã‚§ãƒƒã‚¯ã—ãŸç”»åƒã®ã€ŒZIPå†…ãƒ‘ã‚¹ã€ã‚’ã€å…¥åŠ›ã—ãŸãƒ•ã‚©ãƒ«ãƒ€ãƒ‘ã‚¹ã®ç›´ä¸‹ã«é…ç½®ã™ã‚‹ã‚ˆã†ã«æ›´æ–°ã—ã¾ã™ã€‚</small>
                    <div class="select-all-checkbox">
                        <input type="checkbox" id="selectAllImagesCheckbox">
                        <label for="selectAllImagesCheckbox">å…¨ã¦é¸æŠ / å…¨ã¦è§£é™¤</label>
                    </div>
                </div>

                <div class="preview">
                    <h2>é¸æŠã•ã‚ŒãŸç”»åƒã¨ZIPå†…ãƒ‘ã‚¹</h2>
                    <p class="folder-instruction">
                        å„ç”»åƒã®æ¨ªã«ã‚ã‚‹å…¥åŠ›æ¬„ã§ã€ZIPãƒ•ã‚¡ã‚¤ãƒ«å†…ã§ã®ä¿å­˜ãƒ‘ã‚¹ã‚’å€‹åˆ¥ã«æŒ‡å®šã§ãã¾ã™ã€‚<br>
                        ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã™ã‚‹ã«ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«åã®å‰ã«ãƒ•ã‚©ãƒ«ãƒ€åã¨ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ <code>/</code> ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚<br>
                        ä¾‹: <code>my_folder/image01.jpg</code> (<code>my_folder</code>ãƒ•ã‚©ãƒ«ãƒ€å†…ã«ä¿å­˜)<br>
                        ä¾‹: <code>category_A/sub_category_B/image02.png</code> (ãƒã‚¹ãƒˆã•ã‚ŒãŸãƒ•ã‚©ãƒ«ãƒ€å†…ã«ä¿å­˜)<br>
                        å…¥åŠ›æ¬„ãŒç©ºã®å ´åˆã€ç”»åƒã¯ZIPãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ«ãƒ¼ãƒˆã«ç›´æ¥ä¿å­˜ã•ã‚Œã¾ã™ã€‚
                    </p>
                    <p id="no-image-message" class="message">ã¾ã ç”»åƒãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
                    <div id="image-list-container">
                        </div>
                </div>
            </div>

            <div class="right-panel">
                <div class="metadata-column-config">
                    <h2>æƒ…å ±è§£æãƒ‡ãƒ¼ã‚¿ã®é …ç›®è¨­å®š</h2>
                    <p class="message" id="column-config-message"></p>
                    <div class="add-column-input">
                        <input type="text" id="newColumnNameInput" placeholder="æ–°ã—ã„é …ç›®å (ä¾‹: label, category)">
                        <button id="addColumnBtn">é …ç›®ã‚’è¿½åŠ </button>
                    </div>
                    <div class="current-columns" id="currentColumnsDisplay">
                        </div>
                </div>

                <div class="metadata-input">
                    <h2>æƒ…å ±è§£æãƒ‡ãƒ¼ã‚¿å…¥åŠ›</h2>
                    <p id="no-metadata-message" class="message">ç”»åƒã‚’é¸æŠã™ã‚‹ã¨ã€ã“ã“ã«è¡¨å½¢å¼ã®å…¥åŠ›æ¬„ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
                    <div class="metadata-table-container">
                        <table id="metadata-table">
                            </table>
                    </div>
                </div>

                <div class="metadata-format-selection">
                    <h2>æƒ…å ±è§£æãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼</h2>
                    <input type="radio" id="formatCsv" name="metadataFormat" value="csv" checked>
                    <label for="formatCsv">CSVå½¢å¼ (.csv)</label>
                    <input type="radio" id="formatTxt" name="metadataFormat" value="txt">
                    <label for="formatTxt">TXTå½¢å¼ (.txt)</label>
                </div>

                <div class="license-settings">
                    <h2>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®š</h2>
                    <div class="input-group">
                        <label for="licenseTemplateSelect">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹é››å‹ã‚’é¸æŠ:</label>
                        <select id="licenseTemplateSelect">
                            <option value="none">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚ãªã„</option>
                            <option value="custom">ã‚«ã‚¹ã‚¿ãƒ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</option>
                            <option value="default_paid">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœ‰æ–™ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</option>
                            <option value="default_free">ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç„¡æ–™ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</option>
                        </select>
                    </div>

                    <div id="providerContactDurationGroup">
                        <div class="input-group" id="datasetProviderGroup">
                            <label for="datasetProviderInput">ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæä¾›è€…å/ä¼šç¤¾å:</label>
                            <input type="text" id="datasetProviderInput" placeholder="ä¾‹: æ ªå¼ä¼šç¤¾ãƒ‡ãƒ¼ã‚¿æä¾›">
                        </div>
                        <div class="input-group" id="contactInfoGroup">
                            <label for="contactInfoInput">é€£çµ¡å…ˆæƒ…å ±:</label>
                            <input type="text" id="contactInfoInput" placeholder="ä¾‹: info@example.com">
                        </div>

                        <div class="input-group" id="contractDurationGroup">
                            <label>å¥‘ç´„æœŸé–“:</label>
                            <div class="date-inputs">
                                <input type="date" id="contractStartDate" disabled>
                                <span>ã€œ</span>
                                <input type="date" id="contractEndDate" disabled>
                            </div>
                            <div class="no-duration-checkbox">
                                <input type="checkbox" id="noContractDurationCheckbox" checked>
                                <label for="noContractDurationCheckbox">å¥‘ç´„æœŸé–“ã‚’è¨­å®šã—ãªã„</label>
                            </div>
                        </div>
                    </div>

                    <div class="input-group" id="freeLicenseOptions" style="display: none;">
                        <label for="freeLicenseSelect">ç„¡æ–™ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®é¸æŠ:</label>
                        <select id="freeLicenseSelect">
                            <option value="mit_license">MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹</option>
                            <option value="apache_license_2_0">Apacheãƒ©ã‚¤ã‚»ãƒ³ã‚¹ 2.0</option>
                            <option value="cc_by_4_0">Creative Commons CC BY 4.0</option>
                        </select>
                    </div>

                    <div class="permission-options">
                        <h3>åˆ©ç”¨è¨±è«¾å†…å®¹</h3>
                        <h4>è¨±å¯äº‹é …</h4>
                        <div class="input-group">
                            <label for="aiTrainingPermissionSelect">ç”ŸæˆAIå­¦ç¿’ã¸ã®åˆ©ç”¨:</label>
                            <select id="aiTrainingPermissionSelect">
                                <option value="ai_learning">ç”ŸæˆAIå­¦ç¿’ã¸ã®åˆ©ç”¨ã‚’è¨±å¯ã™ã‚‹</option>
                                <option value="ai_analysis">ç”ŸæˆAIå­¦ç¿’ã‚„ãã®ä»–æƒ…å ±è§£æã¸ã®åˆ©ç”¨ã‚’è¨±å¯ã™ã‚‹</option>
                                <option value="ai_minor_use">ç”ŸæˆAIå­¦ç¿’ã‚„ãã®ä»–æƒ…å ±è§£æã¸ã®åˆ©ç”¨åŠã³ãã®çµæœã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®è»½å¾®åˆ©ç”¨ã‚’è¨±å¯ã™ã‚‹</option>
                            </select>
                        </div>
                        <div class="permission-option sub-option">
                            <input type="checkbox" id="requireAIAttribution" checked>
                            <label for="requireAIAttribution">ç”ŸæˆAIç”Ÿæˆç‰©ã«å½“è©²ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã—ãŸã“ã¨ã‚’æ˜è¨˜ã™ã‚‹ã“ã¨ã‚’ç¾©å‹™ä»˜ã‘ã‚‹</label>
                        </div>
                        <div class="permission-option">
                            <input type="checkbox" id="allowCommercialUse" checked>
                            <label for="allowCommercialUse">å•†ç”¨åˆ©ç”¨ã‚’è¨±å¯ã™ã‚‹</label>
                        </div>
                        <div class="permission-option">
                            <input type="checkbox" id="allowModification" checked>
                            <label for="allowModification">ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æ”¹å¤‰ã‚’è¨±å¯ã™ã‚‹</label>
                        </div>
                        <div class="permission-option">
                            <input type="checkbox" id="allowRedistribution">
                            <label for="allowRedistribution">ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®å†é…å¸ƒã‚’è¨±å¯ã™ã‚‹</label>
                        </div>
                        <div class="permission-option">
                            <input type="checkbox" id="requireServiceCredit">
                            <label for="requireServiceCredit">å½“è©²ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’åˆ©ç”¨ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆè¡¨è¨˜ã‚’ç¾©å‹™ä»˜ã‘ã‚‹</label>
                        </div>

                        <h4>ç¦æ­¢äº‹é …</h4>
                        <div class="permission-option">
                            <input type="checkbox" id="allowNonCommercialUseOnly">
                            <label for="allowNonCommercialUseOnly">éäº«å—åˆ©ç”¨ä»¥å¤–ã®åˆ©ç”¨ã‚’ç¦æ­¢ã™ã‚‹</label>
                        </div>
                        <div class="permission-option">
                            <input type="checkbox" id="prohibitReligiousPolitical">
                            <label for="prohibitReligiousPolitical">å®—æ•™ã€æ”¿æ²»é–¢ä¿‚ã®åˆ©ç”¨ã‚’ç¦æ­¢ã™ã‚‹</label>
                        </div>
                        <div class="permission-option">
                            <input type="checkbox" id="prohibitEroticGrotesque">
                            <label for="prohibitEroticGrotesque">ã‚¨ãƒ­ã€ã‚°ãƒ­ãƒ†ã‚¹ã‚¯é–¢ä¿‚ã®AIç”Ÿæˆã¸ã®åˆ©ç”¨ã‚’ç¦æ­¢ã™ã‚‹</label>
                        </div>
                        <div class="permission-option">
                            <input type="checkbox" id="prohibitThirdPartyReproduction">
                            <label for="prohibitThirdPartyReproduction">AIç”Ÿæˆç‰©ã«ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå†…è‘—ä½œç‰©ã®è¤‡è£½ç‰©ãŒå«ã¾ã‚Œã¦ã„ãŸå ´åˆã€ç¬¬ä¸‰è€…ã¸ã®æä¾›ã‚’ç¦æ­¢ã™ã‚‹(AIäº‹æ¥­è€…ã®è²¬ä»»ã¨ã™ã‚‹)</label>
                        </div>
                    </div>

                    <div class="input-group">
                        <label for="licenseContentTextarea">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å†…å®¹:</label>
                        <textarea id="licenseContentTextarea" placeholder="ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœ‰æ–™ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚„ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç„¡æ–™ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’é¸æŠã™ã‚‹ã¨è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚" disabled></textarea>
                    </div>
                    <div class="input-group">
                        <label for="licenseFileNameInput">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«å:</label>
                        <input type="text" id="licenseFileNameInput" value="LICENSE.txt">
                    </div>
                </div>
            </div>
        </div>

        <div class="zip-preview">
            <h2>ä½œæˆäºˆå®šã®ZIPãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹</h2>
            <ul id="zip-content-preview">
                </ul>
            <p id="no-zip-content-message" class="message">ZIPãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
        </div>

        <button id="downloadZipBtn" disabled>ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
        <div class="loading-spinner" id="loadingSpinner"></div>
        <p id="status-message" class="message"></p>

        <div class="notes-section">
            <h2>æ³¨æ„äº‹é …</h2>
            <ul>
                <li>ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚å‹•ç”»ã€éŸ³å£°ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ãªã©ã€ç”»åƒä»¥å¤–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯å‡¦ç†ã§ãã¾ã›ã‚“ã€‚</li>
                <li>å¤§é‡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ‰±ã†å ´åˆã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ¡ãƒ¢ãƒªã‚„å‡¦ç†èƒ½åŠ›ã®é™ç•Œã«ã‚ˆã‚Šã€å‹•ä½œãŒé‡ããªã£ãŸã‚Šã€å‡¦ç†ã«æ™‚é–“ãŒã‹ã‹ã£ãŸã‚Šã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</li>
                <li>ã“ã®ãƒ„ãƒ¼ãƒ«ã¯å®Œå…¨ã«ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ï¼ˆãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶å†…ï¼‰ã§å‹•ä½œã—ã¾ã™ã€‚é¸æŠã•ã‚ŒãŸç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚„å…¥åŠ›ã•ã‚ŒãŸæƒ…å ±ã¯ã€ã„ã‹ãªã‚‹ã‚µãƒ¼ãƒãƒ¼ã«ã‚‚é€ä¿¡ã•ã‚Œã¾ã›ã‚“ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã¯ä¿è­·ã•ã‚Œã¾ã™ãŒã€ãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¿ãƒ–ã‚’é–‰ã˜ã‚‹ã¨ä½œæ¥­ä¸­ã®ãƒ‡ãƒ¼ã‚¿ã¯å¤±ã‚ã‚Œã¾ã™ã€‚</li>
                <li>è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯ã‚ãã¾ã§ä¸€èˆ¬çš„ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã§ã™ã€‚å®Ÿéš›ã®å•†ç”¨åˆ©ç”¨ã‚„æ³•çš„ãªå¥‘ç´„ã«ãŠã„ã¦ã¯ã€å°‚é–€å®¶ï¼ˆå¼è­·å£«ãªã©ï¼‰ã«ã‚ˆã‚‹ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å—ã‘ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚ã“ã®ãƒ„ãƒ¼ãƒ«ã¯æ³•çš„ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            </ul>
        </div>
    </div>

    <script>
        // HTMLè¦ç´ ã‚’JavaScriptå¤‰æ•°ã«æ ¼ç´ã—ã¾ã™
        const imageInput = document.getElementById('imageInput');
        const imageListContainer = document.getElementById('image-list-container');
        const noImageMessage = document.getElementById('no-image-message');
        const zipContentPreview = document.getElementById('zip-content-preview');
        const noZipContentMessage = document.getElementById('no-zip-content-message');
        const downloadZipBtn = document.getElementById('downloadZipBtn');
        const statusMessage = document.getElementById('status-message');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const formatCsvRadio = document.getElementById('formatCsv');
        const formatTxtRadio = document.getElementById('formatTxt');

        // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é …ç›®è¨­å®šé–¢é€£ã®è¦ç´ 
        const newColumnNameInput = document.getElementById('newColumnNameInput');
        const addColumnBtn = document.getElementById('addColumnBtn');
        const currentColumnsDisplay = document.getElementById('currentColumnsDisplay');
        const columnConfigMessage = document.getElementById('column-config-message');

        // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ãƒ†ãƒ¼ãƒ–ãƒ«é–¢é€£ã®è¦ç´ 
        const metadataTable = document.getElementById('metadata-table');
        const noMetadataMessage = document.getElementById('no-metadata-message');

        // ä¸€æ‹¬ãƒ•ã‚©ãƒ«ãƒ€æŒ‡å®šé–¢é€£ã®è¦ç´ 
        const bulkFolderPathInput = document.getElementById('bulkFolderPathInput');
        const applyBulkFolderBtn = document.getElementById('applyBulkFolderBtn');
        const selectAllImagesCheckbox = document.getElementById('selectAllImagesCheckbox'); // å…¨ã¦é¸æŠ/è§£é™¤ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹

        // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹è¨­å®šé–¢é€£ã®è¦ç´ 
        const licenseTemplateSelect = document.getElementById('licenseTemplateSelect');
        const licenseContentTextarea = document.getElementById('licenseContentTextarea');
        const licenseFileNameInput = document.getElementById('licenseFileNameInput');

        // æ–°ã—ãè¿½åŠ ã•ã‚ŒãŸè¦ç´ 
        const freeLicenseSelect = document.getElementById('freeLicenseSelect');
        const freeLicenseOptionsDiv = document.getElementById('freeLicenseOptions');
        const providerContactDurationGroup = document.getElementById('providerContactDurationGroup');
        const datasetProviderGroup = document.getElementById('datasetProviderGroup'); // ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæä¾›è€…å/ä¼šç¤¾åã®ã‚°ãƒ«ãƒ¼ãƒ—
        const contactInfoGroup = document.getElementById('contactInfoGroup'); // é€£çµ¡å…ˆæƒ…å ±ã®ã‚°ãƒ«ãƒ¼ãƒ—
        const contractDurationGroup = document.getElementById('contractDurationGroup'); // å¥‘ç´„æœŸé–“ã®ã‚°ãƒ«ãƒ¼ãƒ—


        // åˆ©ç”¨è¨±è«¾å†…å®¹ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹
        const aiTrainingPermissionSelect = document.getElementById('aiTrainingPermissionSelect'); // æ–°ã—ã„ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³
        const requireAIAttributionCheckbox = document.getElementById('requireAIAttribution');
        const allowCommercialUseCheckbox = document.getElementById('allowCommercialUse');
        const allowRedistributionCheckbox = document.getElementById('allowRedistribution');
        const allowModificationCheckbox = document.getElementById('allowModification');
        const allowNonCommercialUseOnlyCheckbox = document.getElementById('allowNonCommercialUseOnly'); // éäº«å—åˆ©ç”¨ã®ã¿
        const requireServiceCreditCheckbox = document.getElementById('requireServiceCredit'); // ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆè¡¨è¨˜ç¾©å‹™
        const prohibitReligiousPoliticalCheckbox = document.getElementById('prohibitReligiousPolitical'); // å®—æ•™ã€æ”¿æ²»é–¢ä¿‚ã®åˆ©ç”¨ç¦æ­¢
        const prohibitEroticGrotesqueCheckbox = document.getElementById('prohibitEroticGrotesque'); // ã‚¨ãƒ­ã€ã‚°ãƒ­ãƒ†ã‚¹ã‚¯é–¢ä¿‚ã®AIç”Ÿæˆåˆ©ç”¨ç¦æ­¢
        const prohibitThirdPartyReproductionCheckbox = document.getElementById('prohibitThirdPartyReproduction'); // AIç”Ÿæˆç‰©è¤‡è£½ç‰©ã®ç¬¬ä¸‰è€…æä¾›ç¦æ­¢

        const permissionOptionsDiv = document.querySelector('.permission-options');

        // æ–°ã—ãè¿½åŠ ã•ã‚ŒãŸãƒ©ã‚¤ã‚»ãƒ³ã‚¹é–¢é€£ã®è¦ç´ 
        const datasetProviderInput = document.getElementById('datasetProviderInput');
        const contactInfoInput = document.getElementById('contactInfoInput');
        const contractStartDateInput = document.getElementById('contractStartDate');
        const contractEndDateInput = document.getElementById('contractEndDate');
        const noContractDurationCheckbox = document.getElementById('noContractDurationCheckbox');


        // é¸æŠã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã¨ãã‚Œã«é–¢é€£ã™ã‚‹æƒ…å ±ã‚’ä¿æŒã™ã‚‹é…åˆ—
        // å„ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ { id: string, file: File, originalFileName: string, zipPath: string, metadata: { [key: string]: string }, isSelectedForBulkEdit: boolean } ã®å½¢å¼
        let selectedFiles = [];

        // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é …ç›®ã®é…åˆ— (å›ºå®šé …ç›® + ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©é …ç›®)
        // 'zipPath' ã¯ã‚·ã‚¹ãƒ†ãƒ å›ºå®šé …ç›®ã§ã€CSV/TXTãƒ•ã‚¡ã‚¤ãƒ«ã«å«ã‚ã‚‹
        // 'originalFileName' ã¯ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯å«ã‚ãªã„ãŒã€å†…éƒ¨ã§å‚ç…§ç”¨ã¨ã—ã¦ä¿æŒ
        let metadataColumns = ['zipPath']; // CSV/TXTã«å‡ºåŠ›ã™ã‚‹é …ç›®

        // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹é››å‹ãƒ‡ãƒ¼ã‚¿ (æœ‰æ–™ã§ã‚ã‚‹ã“ã¨ã‚’å‰æã¨ã—ãŸé››å‹)
        const licenseTemplates = {
            none: '', // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å«ã‚ãªã„
            custom: '', // ã‚«ã‚¹ã‚¿ãƒ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯åˆæœŸå€¤ãŒç©ºã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¥åŠ›
            default_paid: `ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆåˆ©ç”¨è¨±è«¾å¥‘ç´„

æœ¬ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åˆ©ç”¨ã«ã¯ã€ä»¥ä¸‹ã®æ¡ä»¶ãŒé©ç”¨ã•ã‚Œã¾ã™ã€‚

1.  ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ç¯„å›²: æœ¬ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ã€[ãƒ©ã‚¤ã‚»ãƒ³ã‚·ãƒ¼å]ã«å¯¾ã—ã¦ã€[åˆ©ç”¨ç›®çš„]ã®ãŸã‚ã«åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚’è¨±å¯ã—ã¾ã™ã€‚æœ¬ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯éç‹¬å çš„ã‹ã¤è­²æ¸¡ä¸èƒ½ã§ã™ã€‚
2.  è‘—ä½œæ¨©: æœ¬ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®è‘—ä½œæ¨©ã¯ã€[è‘—ä½œæ¨©è€…å]ã«å¸°å±ã—ã¾ã™ã€‚
3.  åˆ©ç”¨è¨±è«¾å†…å®¹:
[PERMISSIONS_PLACEHOLDER]
4.  ç¦æ­¢äº‹é …:
    * æœ¬ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã§æ˜ç¤ºçš„ã«è¨±å¯ã•ã‚Œã¦ã„ãªã„åˆ©ç”¨ã€‚
    * é•æ³•ãªç›®çš„ã§ã®åˆ©ç”¨ã€‚
    * æœ¬ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®å…¨éƒ¨ã¾ãŸã¯ä¸€éƒ¨ã‚’ã€æœ¬ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã§æ˜ç¤ºçš„ã«è¨±å¯ã•ã‚Œã¦ã„ãªã„æ–¹æ³•ã§ã€ç¬¬ä¸‰è€…ã«å†é…å¸ƒã€è²©å£²ã€ã‚µãƒ–ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ä¾›ä¸ã€ã¾ãŸã¯è²¸ä¸ã™ã‚‹ã“ã¨ã€‚
    * æœ¬ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ã€ç¬¬ä¸‰è€…ãŒã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªå½¢ã§å…¬é–‹ã™ã‚‹ã“ã¨ï¼ˆåˆ¥é€”åˆæ„ãŒã‚ã‚‹å ´åˆã‚’é™¤ãï¼‰ã€‚
[PROHIBITIONS_PLACEHOLDER]
5.  å…è²¬äº‹é …: æœ¬ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¯ã€Œç¾çŠ¶æœ‰å§¿ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºçš„ã¾ãŸã¯é»™ç¤ºçš„ã‚’å•ã‚ãšã€ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚æä¾›è€…ã¯ã€æœ¬ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®åˆ©ç”¨ã¾ãŸã¯åˆ©ç”¨ä¸èƒ½ã«èµ·å› ã™ã‚‹ã„ã‹ãªã‚‹æå®³ã«ã¤ã„ã¦ã‚‚è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚
6.  å¥‘ç´„æœŸé–“: [CONTRACT_DURATION_PLACEHOLDER]
7.  æº–æ‹ æ³•: æœ¬ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯ã€[å›½å]ã®æ³•å¾‹ã«æº–æ‹ ã—ã€åŒæ³•ã«å¾“ã£ã¦è§£é‡ˆã•ã‚Œã‚‹ã‚‚ã®ã¨ã—ã¾ã™ã€‚

æœ¬ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€åˆ©ç”¨è€…ã¯æœ¬å¥‘ç´„ã®å…¨ã¦ã®æ¡é …ã«åŒæ„ã—ãŸã‚‚ã®ã¨ã¿ãªã•ã‚Œã¾ã™ã€‚

[æ—¥ä»˜]
[æä¾›è€…å/ä¼šç¤¾å]
[é€£çµ¡å…ˆæƒ…å ±]
`,
            mit_license: `MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹

Copyright (c) [YEAR] [COPYRIGHT_HOLDER]

æœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ä½¿ç”¨ã€è¤‡è£½ã€å¤‰æ›´ã€çµåˆã€å…¬é–‹ã€é…å¸ƒã€ã‚µãƒ–ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ä¾›ä¸ã€è²©å£²ã‚’ã€ç„¡å„Ÿã§ã€åˆ¶é™ãªãè¨±å¯ã—ã¾ã™ã€‚ãŸã ã—ã€ä»¥ä¸‹ã®æ¡ä»¶ã«å¾“ã†ã‚‚ã®ã¨ã—ã¾ã™ã€‚

ä¸Šè¨˜ã®è‘—ä½œæ¨©è¡¨ç¤ºãŠã‚ˆã³æœ¬è¨±å¯è¡¨ç¤ºã¯ã€ã™ã¹ã¦ã®è¤‡è£½ã¾ãŸã¯å®Ÿè³ªçš„ãªéƒ¨åˆ†ã«å«ã¾ã‚Œã‚‹ã‚‚ã®ã¨ã—ã¾ã™ã€‚

æœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€Œç¾çŠ¶æœ‰å§¿ã€ã§æä¾›ã•ã‚Œã€ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚è‘—è€…ã¾ãŸã¯è‘—ä½œæ¨©è€…ã¯ã€æœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®ä½¿ç”¨ã¾ãŸã¯ãã®ä»–ã®å–å¼•ã«èµ·å› ã™ã‚‹ã„ã‹ãªã‚‹æå®³ã«ã¤ã„ã¦ã‚‚è²¬ä»»ã‚’è² ã‚ãªã„ã‚‚ã®ã¨ã—ã¾ã™ã€‚
`,
            apache_license_2_0: `Apacheãƒ©ã‚¤ã‚»ãƒ³ã‚¹
ãƒãƒ¼ã‚¸ãƒ§ãƒ³2.0, 2004å¹´1æœˆ

ä½¿ç”¨ã€è¤‡è£½ã€ãŠã‚ˆã³é…å¸ƒã«é–¢ã™ã‚‹æ¡ä»¶

1. å®šç¾©
   ã€Œãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã€ã¨ã¯ã€æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³1ã‹ã‚‰9ã§å®šç¾©ã•ã‚ŒãŸã€ä½¿ç”¨ã€è¤‡è£½ã€ãŠã‚ˆã³é…å¸ƒã«é–¢ã™ã‚‹æ¡ä»¶ã‚’æ„å‘³ã—ã¾ã™ã€‚
   ï¼ˆã“ã‚Œã¯ç°¡ç•¥åŒ–ã•ã‚ŒãŸè¡¨ç¾ã§ã™ã€‚å®Œå…¨ãªApache 2.0ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ãƒ†ã‚­ã‚¹ãƒˆã¯ã¯ã‚‹ã‹ã«é•·ãã€å®Ÿéš›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ãã‚Œã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ï¼‰

   [COPYRIGHT_HOLDER_PLACEHOLDER]

   ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ”ãƒ¼ã¯ä»¥ä¸‹ã§å…¥æ‰‹ã§ãã¾ã™ã€‚
   http://www.apache.org/licenses/LICENSE-2.0

æ³•å¾‹ã§ç¾©å‹™ä»˜ã‘ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆã€ã¾ãŸã¯æ›¸é¢ã§åˆæ„ã•ã‚Œã¦ã„ã‚‹å ´åˆã‚’é™¤ãã€ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã«åŸºã¥ã„ã¦é…å¸ƒã•ã‚Œã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã¯ã€ã€Œç¾çŠ¶æœ‰å§¿ã€ã§é…å¸ƒã•ã‚Œã€æ˜ç¤ºçš„ã¾ãŸã¯é»™ç¤ºçš„ã‚’å•ã‚ãšã€ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã«åŸºã¥ãè¨±å¯ãŠã‚ˆã³åˆ¶é™ã‚’è¦å®šã™ã‚‹ç‰¹å®šã®è¨€èªã«ã¤ã„ã¦ã¯ã€ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
`,
            cc_by_4_0: `ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–ãƒ»ã‚³ãƒ¢ãƒ³ã‚º è¡¨ç¤º 4.0 å›½éš› ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

åˆ©ç”¨è€…ã¯ã€æœ¬ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®æ¡ä»¶ã‚’å—è«¾ã—åŒæ„ã™ã‚‹ã“ã¨ã«ã‚ˆã‚Šã€è¨±è«¾ã•ã‚ŒãŸæ¨©åˆ©ã‚’è¡Œä½¿ã§ãã¾ã™ã€‚

ç¬¬1æ¡ â€“ å®šç¾©
a. æ”¹å¤‰ã•ã‚ŒãŸãƒãƒ†ãƒªã‚¢ãƒ«ã¨ã¯ã€è¨±è«¾ã•ã‚ŒãŸãƒãƒ†ãƒªã‚¢ãƒ«ã‹ã‚‰æ´¾ç”Ÿã¾ãŸã¯åŸºã¥ã„ã¦ãŠã‚Šã€è‘—ä½œæ¨©è€…ã®è¨±å¯ã‚’å¿…è¦ã¨ã™ã‚‹æ–¹æ³•ã§å¤‰æ›´ã•ã‚ŒãŸãƒãƒ†ãƒªã‚¢ãƒ«ã‚’æ„å‘³ã—ã¾ã™ã€‚
ï¼ˆã“ã‚Œã¯ç°¡ç•¥åŒ–ã•ã‚ŒãŸè¡¨ç¾ã§ã™ã€‚å®Œå…¨ãªCC BY 4.0ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ãƒ†ã‚­ã‚¹ãƒˆã¯ã¯ã‚‹ã‹ã«é•·ãã€å®Ÿéš›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ãã‚Œã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ï¼‰

   [COPYRIGHT_HOLDER_PLACEHOLDER]

   ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ã‚³ãƒ”ãƒ¼ã¯ä»¥ä¸‹ã§å…¥æ‰‹ã§ãã¾ã™ã€‚
   http://creativecommons.org/licenses/by/4.0/legalcode

ã“ã‚Œã¯æ³•çš„ãªã‚³ãƒ¼ãƒ‰ã®äººé–“ãŒèª­ã‚ã‚‹è¦ç´„ã§ã™ã€‚æ³•çš„ãªã‚³ãƒ¼ãƒ‰ï¼ˆå®Œå…¨ãªãƒ©ã‚¤ã‚»ãƒ³ã‚¹ï¼‰ã®ã¿ãŒã€ã‚ãªãŸã‚’æ‹˜æŸã™ã‚‹æ¡ä»¶ã®å”¯ä¸€ã®å‡ºå…¸ã§ã™ã€‚
`
        };


        // ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªIDã‚’ç”Ÿæˆã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
        const generateUniqueId = () => Date.now().toString(36) + Math.random().toString(36).substring(2);

        // CSVå€¤ã®ç‰¹æ®Šæ–‡å­—ã‚’ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã™ã‚‹é–¢æ•°
        const escapeCsvValue = (value) => {
            if (value === null || value === undefined) {
                return '';
            }
            let stringValue = String(value);
            // å€¤ã«ã‚«ãƒ³ãƒã€äºŒé‡å¼•ç”¨ç¬¦ã€æ”¹è¡ŒãŒå«ã¾ã‚Œã‚‹å ´åˆã¯äºŒé‡å¼•ç”¨ç¬¦ã§å›²ã¿ã€å†…éƒ¨ã®äºŒé‡å¼•ç”¨ç¬¦ã¯äºŒé‡ã«ã™ã‚‹
            if (stringValue.includes(',') || stringValue.includes('"') || stringValue.includes('\n') || stringValue.includes('\r')) {
                return '"' + stringValue.replace(/"/g, '""') + '"';
            }
            return stringValue;
        };

        // ç”»åƒãƒªã‚¹ãƒˆã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é …ç›®è¡¨ç¤ºã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã€ZIPå†…å®¹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ã™ã¹ã¦ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹é–¢æ•°
        const renderAllPreviews = () => {
            renderImageList();         // ç”»åƒãƒªã‚¹ãƒˆã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
            renderMetadataColumns();   // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é …ç›®è¡¨ç¤ºã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
            renderMetadataTable();     // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
            updateZipContentPreview(); // ZIPå†…å®¹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®æ›´æ–°
            updateSelectAllCheckboxState(); // ã€Œå…¨ã¦é¸æŠ/è§£é™¤ã€ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®çŠ¶æ…‹ã‚’æ›´æ–°
            updateLicenseContent(); // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å†…å®¹ã‚’æ›´æ–°
        };

        // ç”»åƒãƒªã‚¹ãƒˆã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹é–¢æ•°
        const renderImageList = () => {
            imageListContainer.innerHTML = ''; // æ—¢å­˜ã®ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢
            if (selectedFiles.length === 0) {
                noImageMessage.style.display = 'block';
                downloadZipBtn.disabled = true;
                selectAllImagesCheckbox.disabled = true; // ç”»åƒãŒãªã„å ´åˆã¯ç„¡åŠ¹åŒ–
            } else {
                noImageMessage.style.display = 'none';
                downloadZipBtn.disabled = false;
                selectAllImagesCheckbox.disabled = false; // ç”»åƒãŒã‚ã‚‹å ´åˆã¯æœ‰åŠ¹åŒ–

                selectedFiles.forEach(item => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const imageItemDiv = document.createElement('div');
                        imageItemDiv.classList.add('image-item');
                        imageItemDiv.dataset.id = item.id; // å‰Šé™¤æ™‚ã«ä½¿ç”¨ã™ã‚‹IDã‚’ãƒ‡ãƒ¼ã‚¿å±æ€§ã¨ã—ã¦ä¿æŒ

                        // ä¸€æ‹¬é¸æŠç”¨ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹
                        const bulkSelectCheckbox = document.createElement('input');
                        bulkSelectCheckbox.type = 'checkbox';
                        bulkSelectCheckbox.classList.add('bulk-select-item-checkbox');
                        bulkSelectCheckbox.checked = item.isSelectedForBulkEdit; // çŠ¶æ…‹ã‚’åæ˜ 
                        bulkSelectCheckbox.addEventListener('change', (e) => {
                            item.isSelectedForBulkEdit = e.target.checked; // çŠ¶æ…‹ã‚’æ›´æ–°
                            updateSelectAllCheckboxState(); // å…¨ä½“é¸æŠãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®çŠ¶æ…‹ã‚’æ›´æ–°
                        });

                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.alt = item.originalFileName; // å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’altã«è¨­å®š

                        const fileDetailsDiv = document.createElement('div');
                        fileDetailsDiv.classList.add('file-details');

                        const fileNameP = document.createElement('p');
                        fileNameP.textContent = `å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«å: ${item.originalFileName}`;

                        // ZIPãƒ‘ã‚¹å…¥åŠ›è¡Œ
                        const pathInputRow = document.createElement('div');
                        pathInputRow.classList.add('input-row');
                        const pathLabel = document.createElement('label');
                        pathLabel.textContent = 'ZIPå†…ãƒ‘ã‚¹:';
                        const pathInput = document.createElement('input');
                        pathInput.type = 'text';
                        pathInput.value = item.zipPath; // ç¾åœ¨ã®ZIPãƒ‘ã‚¹ã‚’åˆæœŸå€¤ã¨ã—ã¦è¨­å®š
                        pathInput.placeholder = 'ä¾‹: folder/image.jpg';
                        // ãƒ‘ã‚¹å…¥åŠ›ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
                        pathInput.addEventListener('input', (e) => {
                            item.zipPath = e.target.value.trim(); // å¤‰æ›´ã•ã‚ŒãŸãƒ‘ã‚¹ã‚’æ›´æ–°
                            renderMetadataTable(); // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°
                            updateZipContentPreview(); // ZIPå†…å®¹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°
                        });
                        pathInputRow.appendChild(pathLabel);
                        pathInputRow.appendChild(pathInput);

                        const deleteButton = document.createElement('button');
                        deleteButton.classList.add('delete-btn');
                        deleteButton.textContent = 'å‰Šé™¤';
                        // å‰Šé™¤ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã¨ãã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
                        deleteButton.addEventListener('click', () => {
                            // é¸æŠã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã‹ã‚‰ã“ã®ç”»åƒã‚’å‰Šé™¤
                            selectedFiles = selectedFiles.filter(f => f.id !== item.id);
                            renderAllPreviews(); // ã™ã¹ã¦ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
                            statusMessage.textContent = ''; // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢
                        });

                        imageItemDiv.appendChild(bulkSelectCheckbox); // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’è¿½åŠ 
                        imageItemDiv.appendChild(img);
                        fileDetailsDiv.appendChild(fileNameP);
                        fileDetailsDiv.appendChild(pathInputRow);
                        imageItemDiv.appendChild(fileDetailsDiv);
                        imageItemDiv.appendChild(deleteButton);
                        imageListContainer.appendChild(imageItemDiv);
                    };
                    // ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã‚’é–‹å§‹ã—ã€æˆåŠŸã—ãŸã‚‰onloadãŒå‘¼ã°ã‚Œã‚‹
                    reader.readAsDataURL(item.file);
                });
            }
        };

        // ã€Œå…¨ã¦é¸æŠ/è§£é™¤ã€ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®çŠ¶æ…‹ã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
        const updateSelectAllCheckboxState = () => {
            if (selectedFiles.length === 0) {
                selectAllImagesCheckbox.checked = false;
                selectAllImagesCheckbox.indeterminate = false; // ä¸ç¢ºå®šçŠ¶æ…‹ã‚’è§£é™¤
                return;
            }
            const allSelected = selectedFiles.every(item => item.isSelectedForBulkEdit);
            const anySelected = selectedFiles.some(item => item.isSelectedForBulkEdit);

            if (allSelected) {
                selectAllImagesCheckbox.checked = true;
                selectAllImagesCheckbox.indeterminate = false;
            } else if (anySelected) {
                selectAllImagesCheckbox.checked = false;
                selectAllImagesCheckbox.indeterminate = true; // ä¸€éƒ¨é¸æŠçŠ¶æ…‹
            } else {
                selectAllImagesCheckbox.checked = false;
                selectAllImagesCheckbox.indeterminate = false;
            }
        };

        // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿é …ç›®è¡¨ç¤ºã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹é–¢æ•°
        const renderMetadataColumns = () => {
            currentColumnsDisplay.innerHTML = ''; // æ—¢å­˜ã®è¡¨ç¤ºã‚’ã‚¯ãƒªã‚¢
            // 'zipPath' ã¯å›ºå®šé …ç›®ã¨ã—ã¦è¡¨ç¤ºã—ãªã„ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©é …ç›®ã®ã¿è¡¨ç¤º
            const userDefinedColumns = metadataColumns.filter(col => col !== 'zipPath');

            if (userDefinedColumns.length === 0) {
                columnConfigMessage.textContent = 'ã¾ã ã‚«ã‚¹ã‚¿ãƒ é …ç›®ãŒã‚ã‚Šã¾ã›ã‚“ã€‚';
            } else {
                columnConfigMessage.textContent = 'ç¾åœ¨ã®ã‚«ã‚¹ã‚¿ãƒ é …ç›®:';
                userDefinedColumns.forEach(column => {
                    const columnTag = document.createElement('div');
                    columnTag.classList.add('column-tag');
                    columnTag.textContent = column;

                    const removeBtn = document.createElement('button');
                    removeBtn.classList.add('remove-column-btn');
                    removeBtn.textContent = 'x';
                    removeBtn.title = `${column} é …ç›®ã‚’å‰Šé™¤`;
                    removeBtn.addEventListener('click', () => {
                        removeCustomColumn(column);
                    });

                    columnTag.appendChild(removeBtn);
                    currentColumnsDisplay.appendChild(columnTag);
                });
            }
        };

        // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹é–¢æ•°
        const renderMetadataTable = () => {
            metadataTable.innerHTML = ''; // æ—¢å­˜ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ã‚¯ãƒªã‚¢

            if (selectedFiles.length === 0) {
                noMetadataMessage.style.display = 'block';
                return;
            } else {
                noMetadataMessage.style.display = 'none';
            }

            // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã®ä½œæˆ
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');

            // ãƒ†ãƒ¼ãƒ–ãƒ«è¡¨ç¤ºç”¨ã®é …ç›®ãƒªã‚¹ãƒˆ (å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å«ã‚ãªã„)
            const displayColumns = [...metadataColumns]; // originalFileName ã‚’å«ã‚ãªã„

            displayColumns.forEach(column => {
                const th = document.createElement('th');
                th.textContent = column === 'zipPath' ? 'ZIPå†…ãƒ‘ã‚¹' : column; // è¡¨ç¤ºåã‚’èª¿æ•´
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            metadataTable.appendChild(thead);

            // ãƒ‡ãƒ¼ã‚¿è¡Œã®ä½œæˆ
            const tbody = document.createElement('tbody');
            selectedFiles.forEach(item => {
                const dataRow = document.createElement('tr');
                displayColumns.forEach(column => {
                    const td = document.createElement('td');
                    let value = '';

                    if (column === 'zipPath') {
                        value = item.zipPath;
                        td.classList.add('fixed-column'); // å›ºå®šåˆ—ã®ã‚¹ã‚¿ã‚¤ãƒ«
                        td.textContent = value; // ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦è¡¨ç¤º
                    } else {
                        // ãƒ¦ãƒ¼ã‚¶ãƒ¼å®šç¾©é …ç›®
                        value = item.metadata[column] || ''; // å€¤ãŒãªã‘ã‚Œã°ç©ºæ–‡å­—åˆ—
                        const input = document.createElement('input');
                        input.type = 'text';
                        input.value = value;
                        input.placeholder = `å…¥åŠ› (${column})`;
                        input.dataset.itemId = item.id;
                        input.dataset.columnName = column;
                        input.addEventListener('input', (e) => {
                            const itemId = e.target.dataset.itemId;
                            const colName = e.target.dataset.columnName;
                            const fileItem = selectedFiles.find(f => f.id === itemId);
                            if (fileItem) {
                                fileItem.metadata[colName] = e.target.value;
                            }
                        });
                        td.appendChild(input);
                    }
                    dataRow.appendChild(td);
                });
                tbody.appendChild(dataRow);
            });
            metadataTable.appendChild(tbody);
        };

        // ZIPå†…å®¹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
        const updateZipContentPreview = () => {
            zipContentPreview.innerHTML = ''; // æ—¢å­˜ã®ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢
            if (selectedFiles.length === 0) {
                noZipContentMessage.style.display = 'block';
            } else {
                noZipContentMessage.style.display = 'none';
                // ZIPãƒ‘ã‚¹ã§ã‚½ãƒ¼ãƒˆã—ã¦è¡¨ç¤ºã™ã‚‹ã¨è¦‹ã‚„ã™ã„
                const sortedPaths = selectedFiles
                    .map(item => item.zipPath || item.originalFileName) // zipPathãŒç©ºã®å ´åˆã¯originalFileNameã‚’ä½¿ç”¨
                    .sort((a, b) => {
                        // ãƒ•ã‚©ãƒ«ãƒ€ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒºåˆ¥ã—ã¦ã‚½ãƒ¼ãƒˆï¼ˆä¾‹: folder/a.jpg, folder/b.jpg, file.jpgï¼‰
                        const isAFolder = a.endsWith('/');
                        const isBFolder = b.endsWith('/');
                        if (isAFolder && !isBFolder) return -1;
                        if (!isAFolder && isBFolder) return 1;
                        return a.localeCompare(b);
                    });

                sortedPaths.forEach(displayPath => {
                    const listItem = document.createElement('li');
                    listItem.textContent = displayPath;
                    zipContentPreview.appendChild(listItem);
                });

                // æƒ…å ±è§£æãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«è¿½åŠ 
                const metadataFileName = getMetadataFileName();
                const metadataListItem = document.createElement('li');
                metadataListItem.classList.add('metadata-file'); // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ç”¨ã®ã‚¯ãƒ©ã‚¹
                metadataListItem.textContent = metadataFileName;
                zipContentPreview.appendChild(metadataListItem);
            }

            // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«è¿½åŠ 
            const licenseFileName = licenseFileNameInput.value.trim();
            const licenseContent = licenseContentTextarea.value.trim();
            if (licenseFileName && licenseContent && licenseTemplateSelect.value !== 'none') { // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒã€Œå«ã‚ãªã„ã€ä»¥å¤–ã®å ´åˆã«è¡¨ç¤º
                const licenseListItem = document.createElement('li');
                licenseListItem.classList.add('license-file'); // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ç”¨ã®ã‚¯ãƒ©ã‚¹
                licenseListItem.textContent = licenseFileName;
                zipContentPreview.appendChild(licenseListItem);
            }
        };

        // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«åã‚’å–å¾—ã™ã‚‹é–¢æ•°
        const getMetadataFileName = () => {
            const format = document.querySelector('input[name="metadataFormat"]:checked').value;
            return `metadata.${format}`;
        };

        // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
        const generateMetadataFileContent = () => {
            let content = '';
            // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ
            content += metadataColumns.map(col => escapeCsvValue(col)).join(',') + '\n';

            // ãƒ‡ãƒ¼ã‚¿è¡Œ
            selectedFiles.forEach(item => {
                const rowValues = metadataColumns.map(column => {
                    if (column === 'zipPath') {
                        return escapeCsvValue(item.zipPath || item.originalFileName);
                    } else {
                        return escapeCsvValue(item.metadata[column] || '');
                    }
                });
                content += rowValues.join(',') + '\n';
            });
            return content;
        };

        // ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚ŒãŸã¨ãã®å‡¦ç†
        imageInput.addEventListener('change', (event) => {
            statusMessage.textContent = ''; // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢
            const newFiles = Array.from(event.target.files);

            newFiles.forEach(file => {
                if (file.type.startsWith('image/')) {
                    // å„ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ¦ãƒ‹ãƒ¼ã‚¯ãªIDã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ZIPãƒ‘ã‚¹ã€ç©ºã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å‰²ã‚Šå½“ã¦ã¦è¿½åŠ 
                    const newFileItem = {
                        id: generateUniqueId(),
                        file: file,
                        originalFileName: file.name, // å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ä¿æŒ
                        zipPath: file.name, // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆZIPã®ãƒ«ãƒ¼ãƒˆã«é…ç½®ï¼‰
                        metadata: {}, // è¿½åŠ æƒ…å ±ã®åˆæœŸå€¤ã¯ç©ºã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
                        isSelectedForBulkEdit: false // ä¸€æ‹¬ç·¨é›†ã®é¸æŠçŠ¶æ…‹ã‚’åˆæœŸåŒ–
                    };
                    // ç¾åœ¨å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚«ã‚¹ã‚¿ãƒ é …ç›®ã‚’æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã«åˆæœŸåŒ–
                    // metadataColumnsã‹ã‚‰å›ºå®šé …ç›®('zipPath')ã‚’é™¤å¤–ã—ã¦ãƒ«ãƒ¼ãƒ—
                    metadataColumns.filter(col => col !== 'zipPath').forEach(col => {
                        newFileItem.metadata[col] = '';
                    });
                    selectedFiles.push(newFileItem);
                }
            });
            // ã™ã¹ã¦ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
            renderAllPreviews();
            // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠå¾Œã€inputã®å€¤ã‚’ã‚¯ãƒªã‚¢ã—ã¦ã€åŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†åº¦é¸æŠã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
            imageInput.value = ''; // ã“ã‚Œã«ã‚ˆã‚Šã€åŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å†åº¦é¸æŠã—ã¦ã‚‚changeã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã™ã‚‹
        });

        // ã‚«ã‚¹ã‚¿ãƒ é …ç›®ã‚’è¿½åŠ ã™ã‚‹ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        addColumnBtn.addEventListener('click', () => {
            const newColumnName = newColumnNameInput.value.trim();
            if (!newColumnName) {
                columnConfigMessage.textContent = 'é …ç›®åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
                columnConfigMessage.style.color = '#e06c75';
                return;
            }
            // æ—¢å­˜ã®é …ç›®åã¨é‡è¤‡ã—ãªã„ã‹ãƒã‚§ãƒƒã‚¯ï¼ˆå›ºå®šé …ç›®ã‚‚å«ã‚€ï¼‰
            if (metadataColumns.includes(newColumnName) || newColumnName === 'originalFileName') {
                columnConfigMessage.textContent = `é …ç›®ã€Œ${newColumnName}ã€ã¯æ—¢ã«å­˜åœ¨ã™ã‚‹ã‹ã€äºˆç´„èªã§ã™ã€‚`;
                columnConfigMessage.style.color = '#e06c75';
                return;
            }

            metadataColumns.push(newColumnName); // æ–°ã—ã„é …ç›®ã‚’è¿½åŠ 
            // æ—¢å­˜ã®ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã«æ–°ã—ã„é …ç›®ã‚’è¿½åŠ ã—åˆæœŸåŒ–
            selectedFiles.forEach(item => {
                item.metadata[newColumnName] = '';
            });

            newColumnNameInput.value = ''; // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã‚¯ãƒªã‚¢
            columnConfigMessage.textContent = `é …ç›®ã€Œ${newColumnName}ã€ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚`;
            columnConfigMessage.style.color = '#98c379';
            renderAllPreviews(); // ã™ã¹ã¦ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        });

        // ã‚«ã‚¹ã‚¿ãƒ é …ç›®ã‚’å‰Šé™¤ã™ã‚‹é–¢æ•°
        const removeCustomColumn = (columnToRemove) => {
            metadataColumns = metadataColumns.filter(col => col !== columnToRemove); // é …ç›®ã‚’å‰Šé™¤
            // æ—¢å­˜ã®ã™ã¹ã¦ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å‰Šé™¤ã•ã‚ŒãŸé …ç›®ã‚’å‰Šé™¤
            selectedFiles.forEach(item => {
                delete item.metadata[columnToRemove];
            });
            columnConfigMessage.textContent = `é …ç›®ã€Œ${columnToRemove}ã€ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚`;
            columnConfigMessage.style.color = '#e06c75';
            renderAllPreviews(); // ã™ã¹ã¦ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        };

        // ä¸€æ‹¬ãƒ•ã‚©ãƒ«ãƒ€æŒ‡å®šã‚’é©ç”¨ã™ã‚‹ãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        applyBulkFolderBtn.addEventListener('click', () => {
            const bulkPath = bulkFolderPathInput.value.trim();
            let normalizedBulkPath = bulkPath;

            if (normalizedBulkPath) {
                // ãƒ‘ã‚¹ãŒã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã§çµ‚ã‚ã£ã¦ã„ãªã„å ´åˆã€è¿½åŠ ã™ã‚‹
                if (!normalizedBulkPath.endsWith('/') && !normalizedBulkPath.endsWith('\\')) {
                    normalizedBulkPath += '/';
                }
                // Windowsã®\ã‚’/ã«å¤‰æ›
                normalizedBulkPath = normalizedPath.replace(/\\/g, '/');
            }

            // é¸æŠã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã‚’å¯¾è±¡ã«ã™ã‚‹
            const filesToUpdate = selectedFiles.filter(item => item.isSelectedForBulkEdit);

            if (filesToUpdate.length === 0) {
                statusMessage.textContent = 'ä¸€æ‹¬æŒ‡å®šã™ã‚‹ç”»åƒãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚';
                statusMessage.style.color = '#e06c75';
                return;
            }

            filesToUpdate.forEach(item => {
                // æ—¢å­˜ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ‘ã‚¹ã‚’å‰Šé™¤ã—ã€æ–°ã—ã„ä¸€æ‹¬ãƒ‘ã‚¹ã®ç›´ä¸‹ã«ãƒ•ã‚¡ã‚¤ãƒ«åã‚’é…ç½®
                item.zipPath = normalizedBulkPath + item.originalFileName;
            });

            statusMessage.textContent = 'é¸æŠã•ã‚ŒãŸç”»åƒã«ä¸€æ‹¬ãƒ•ã‚©ãƒ«ãƒ€æŒ‡å®šã‚’é©ç”¨ã—ã¾ã—ãŸã€‚';
            statusMessage.style.color = '#98c379';
            renderAllPreviews(); // UIã‚’æ›´æ–°
        });

        // ã€Œå…¨ã¦é¸æŠ / å…¨ã¦è§£é™¤ã€ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®çŠ¶æ…‹ã‚’æ›´æ–°ã™ã‚‹é–¢æ•°
        selectAllImagesCheckbox.addEventListener('change', (e) => {
            const isChecked = e.target.checked;
            selectedFiles.forEach(item => {
                item.isSelectedForBulkEdit = isChecked;
            });
            // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®çŠ¶æ…‹å¤‰æ›´ãŒåæ˜ ã•ã‚Œã‚‹ã‚ˆã†ã«å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¯ä¸è¦ã ãŒã€
            // å¿µã®ãŸã‚renderImageListã‚’å‘¼ã³å‡ºã—ã¦ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®çŠ¶æ…‹ã‚’æ›´æ–°
            renderImageList();
            updateSelectAllCheckboxState(); // è¦ªã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®çŠ¶æ…‹ã‚‚æ›´æ–°
        });


        // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å†…å®¹ã‚’ç”Ÿæˆã™ã‚‹é–¢æ•°
        const generateLicenseContent = () => {
            const selectedTemplate = licenseTemplateSelect.value;
            let content = '';

            // æä¾›è€…åã¨é€£çµ¡å…ˆãŒå…¥åŠ›ã•ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
            const providerName = datasetProviderInput.value.trim();
            const contactInfo = contactInfoInput.value.trim();
            const currentYear = new Date().getFullYear();

            if (selectedTemplate === 'none') {
                return '';
            } else if (selectedTemplate === 'custom') {
                return licenseContentTextarea.value; // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå…¥åŠ›ã—ãŸå†…å®¹ã‚’ãã®ã¾ã¾è¿”ã™
            } else if (selectedTemplate === 'default_paid') {
                content = licenseTemplates.default_paid;

                let permissionsText = [];
                const selectedAITrainingOption = aiTrainingPermissionSelect.value;

                // ç”ŸæˆAIå­¦ç¿’ã¸ã®åˆ©ç”¨ã«é–¢ã™ã‚‹è¨±å¯
                if (selectedAITrainingOption === 'ai_learning') {
                    permissionsText.push("    - ç”ŸæˆAIå­¦ç¿’ã¸ã®åˆ©ç”¨ã‚’è¨±å¯ã—ã¾ã™ã€‚");
                } else if (selectedAITrainingOption === 'ai_analysis') {
                    permissionsText.push("    - ç”ŸæˆAIå­¦ç¿’ã‚„ãã®ä»–æƒ…å ±è§£æã¸ã®åˆ©ç”¨ã‚’è¨±å¯ã—ã¾ã™ã€‚");
                } else if (selectedAITrainingOption === 'ai_minor_use') {
                    permissionsText.push("    - ç”ŸæˆAIå­¦ç¿’ã‚„ãã®ä»–æƒ…å ±è§£æã¸ã®åˆ©ç”¨åŠã³ãã®çµæœã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®è»½å¾®åˆ©ç”¨ã‚’è¨±å¯ã—ã¾ã™ã€‚");
                }

                if (requireAIAttributionCheckbox.checked) { // å¸¸ã«æœ‰åŠ¹ãªã®ã§ã€ãƒã‚§ãƒƒã‚¯çŠ¶æ…‹ã®ã¿ç¢ºèª
                    permissionsText.push("        - ç”ŸæˆAIç”Ÿæˆç‰©ã«å½“è©²ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ç”¨ã—ãŸã“ã¨ã‚’æ˜è¨˜ã™ã‚‹ã“ã¨ã‚’ç¾©å‹™ä»˜ã‘ã¾ã™ã€‚");
                }

                if (allowCommercialUseCheckbox.checked) {
                    permissionsText.push("    - å•†ç”¨åˆ©ç”¨ã‚’è¨±å¯ã—ã¾ã™ã€‚");
                } else {
                    permissionsText.push("    - å•†ç”¨åˆ©ç”¨ã¯è¨±å¯ã•ã‚Œã¾ã›ã‚“ã€‚");
                }

                if (allowModificationCheckbox.checked) {
                    permissionsText.push("    - ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æ”¹å¤‰ã‚’è¨±å¯ã—ã¾ã™ã€‚");
                } else {
                    permissionsText.push("    - ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®æ”¹å¤‰ã¯è¨±å¯ã•ã‚Œã¾ã›ã‚“ã€‚");
                }

                if (allowRedistributionCheckbox.checked) {
                    permissionsText.push("    - ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®å†é…å¸ƒã‚’è¨±å¯ã—ã¾ã™ï¼ˆåˆ¥é€”å¥‘ç´„ãŒãªã„é™ã‚Šã€ç„¡å„Ÿã§ã®å†é…å¸ƒã«é™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼‰ã€‚");
                } else {
                    permissionsText.push("    - ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®å†é…å¸ƒã¯è¨±å¯ã•ã‚Œã¾ã›ã‚“ã€‚");
                }
                
                if (requireServiceCreditCheckbox.checked) {
                    permissionsText.push("    - å½“è©²ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’åˆ©ç”¨ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆè¡¨è¨˜ã‚’ç¾©å‹™ä»˜ã‘ã¾ã™ã€‚");
                } else {
                    permissionsText.push("    - å½“è©²ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’åˆ©ç”¨ã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆè¡¨è¨˜ã¯ç¾©å‹™ä»˜ã‘ã‚‰ã‚Œã¾ã›ã‚“ã€‚");
                }


                content = content.replace('[PERMISSIONS_PLACEHOLDER]', permissionsText.join('\n'));

                let prohibitionsText = [];
                // ç¦æ­¢äº‹é …
                if (allowNonCommercialUseOnlyCheckbox.checked) {
                    prohibitionsText.push("    * éäº«å—åˆ©ç”¨ä»¥å¤–ã®åˆ©ç”¨ã‚’ç¦æ­¢ã—ã¾ã™ã€‚");
                }
                if (prohibitReligiousPoliticalCheckbox.checked) {
                    prohibitionsText.push("    * å®—æ•™ã€æ”¿æ²»é–¢ä¿‚ã®åˆ©ç”¨ã‚’ç¦æ­¢ã—ã¾ã™ã€‚");
                }
                if (prohibitEroticGrotesqueCheckbox.checked) {
                    prohibitionsText.push("    * ã‚¨ãƒ­ã€ã‚°ãƒ­ãƒ†ã‚¹ã‚¯é–¢ä¿‚ã®AIç”Ÿæˆã¸ã®åˆ©ç”¨ã‚’ç¦æ­¢ã—ã¾ã™ã€‚");
                }
                if (prohibitThirdPartyReproductionCheckbox.checked) {
                    if (selectedAITrainingOption === 'ai_minor_use') {
                        prohibitionsText.push("    * å½“è©²ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’åˆ©ç”¨ã—ãŸAIç”Ÿæˆç‰©ã«å½“è©²ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå†…è‘—ä½œç‰©ã®ã™ã¹ã¦ã¾ãŸã¯ä¸€éƒ¨ã®è¤‡è£½ç‰©ãŒå«ã¾ã‚Œã¦ã„ãŸå ´åˆã€ç¬¬ä¸‰è€…ã¸ã®æä¾›ã‚’ç¦æ­¢ã—ã¾ã™ï¼ˆAIäº‹æ¥­è€…ã®è²¬ä»»ã¨ã—ã¾ã™ï¼‰ãŸã ã—è»½å¾®åˆ©ç”¨ã‚’é™¤ãã¾ã™ã€‚");
                    } else {
                        prohibitionsText.push("    * å½“è©²ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’åˆ©ç”¨ã—ãŸAIç”Ÿæˆç‰©ã«å½“è©²ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆå†…è‘—ä½œç‰©ã®ã™ã¹ã¦ã¾ãŸã¯ä¸€éƒ¨ã®è¤‡è£½ç‰©ãŒå«ã¾ã‚Œã¦ã„ãŸå ´åˆã€ç¬¬ä¸‰è€…ã¸ã®æä¾›ã‚’ç¦æ­¢ã—ã¾ã™ï¼ˆAIäº‹æ¥­è€…ã®è²¬ä»»ã¨ã—ã¾ã™ï¼‰ã€‚");
                    }
                }

                // ç¦æ­¢äº‹é …ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’ç½®ãæ›ãˆã‚‹ã€‚ç¦æ­¢äº‹é …ãŒãªã‘ã‚Œã°ç©ºè¡Œã‚’å‰Šé™¤
                if (prohibitionsText.length > 0) {
                    content = content.replace('[PROHIBITIONS_PLACEHOLDER]', '\n' + prohibitionsText.join('\n'));
                } else {
                    content = content.replace('[PROHIBITIONS_PLACEHOLDER]', ''); // ç¦æ­¢äº‹é …ãŒãªã‘ã‚Œã°ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’å‰Šé™¤
                }


                // å¥‘ç´„æœŸé–“ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’ç½®ãæ›ãˆã‚‹
                let contractDurationText = '';
                if (noContractDurationCheckbox.checked) {
                    contractDurationText = 'æœŸé–“ã®å®šã‚ãªã—'; // ç°¡æ½”ãªè¡¨ç¾ã«ä¿®æ­£
                } else {
                    const startDate = contractStartDateInput.value;
                    const endDate = contractEndDateInput.value;
                    if (startDate && endDate) {
                        contractDurationText = `${startDate}ã‹ã‚‰${endDate}ã¾ã§`;
                    } else if (startDate) {
                        contractDurationText = `${startDate}ã‹ã‚‰åˆ¥é€”åˆæ„ã•ã‚ŒãŸæœŸé–“ã¾ã§`;
                    } else if (endDate) {
                        contractDurationText = `åˆ¥é€”åˆæ„ã•ã‚ŒãŸæœŸé–“ã‹ã‚‰${endDate}ã¾ã§`;
                    } else {
                        contractDurationText = 'åˆ¥é€”å¥‘ç´„ã«å®šã‚ã‚‹';
                    }
                }
                content = content.replace('[CONTRACT_DURATION_PLACEHOLDER]', contractDurationText);


                // ãã®ä»–ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚‚ç½®ãæ›ãˆã‚‹
                const currentDate = new Date().toLocaleDateString('ja-JP', { year: 'numeric', month: 'long', day: 'numeric' });
                content = content.replace(/\[ãƒ©ã‚¤ã‚»ãƒ³ã‚·ãƒ¼å\]/g, 'è²´ç¤¾/è²´æ®¿'); // ä»®ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
                content = content.replace(/\[åˆ©ç”¨ç›®çš„\]/g, 'æœ¬ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ç¯„å›²å†…'); // ä»®ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
                // æä¾›è€…åã‚„é€£çµ¡å…ˆãŒç©ºã®å ´åˆã€ç©ºæ–‡å­—åˆ—ã§ç½®ãæ›ãˆ
                content = content.replace(/\[è‘—ä½œæ¨©è€…å\]/g, providerName || '');
                content = content.replace(/\[å›½å\]/g, 'æ—¥æœ¬å›½'); // ä»®ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
                content = content.replace(/\[æ—¥ä»˜\]/g, currentDate);
                content = content.replace(/\[æä¾›è€…å\/ä¼šç¤¾å\]/g, providerName || '');
                content = content.replace(/\[é€£çµ¡å…ˆæƒ…å ±\]/g, contactInfo || '');

                return content;
            } else if (selectedTemplate === 'default_free') {
                const selectedFreeLicense = freeLicenseSelect.value;
                let licenseText = licenseTemplates[selectedFreeLicense];

                // ç„¡æ–™ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’ç½®ãæ›ãˆã‚‹
                licenseText = licenseText.replace(/\[YEAR\]/g, currentYear);
                licenseText = licenseText.replace(/\[COPYRIGHT_HOLDER\]/g, providerName || 'è‘—ä½œæ¨©è€…'); // æä¾›è€…åãŒãªã‘ã‚Œã°ã€Œè‘—ä½œæ¨©è€…ã€
                licenseText = licenseText.replace(/\[COPYRIGHT_HOLDER_PLACEHOLDER\]/g, providerName || 'è‘—ä½œæ¨©è€…');

                return licenseText;
            }
            return '';
        };

        // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹é››å‹é¸æŠã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        licenseTemplateSelect.addEventListener('change', () => {
            const selectedTemplate = licenseTemplateSelect.value;

            // ã¾ãšã™ã¹ã¦ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’éè¡¨ç¤ºãƒ»ç„¡åŠ¹åŒ–
            licenseContentTextarea.value = '';
            licenseContentTextarea.disabled = true;
            licenseFileNameInput.value = '';
            permissionOptionsDiv.style.display = 'none';
            freeLicenseOptionsDiv.style.display = 'none';
            
            // æä¾›è€…ã€é€£çµ¡å…ˆã€å¥‘ç´„æœŸé–“ã®è¦ªã‚°ãƒ«ãƒ¼ãƒ—ã¨å­è¦ç´ ã‚’ã™ã¹ã¦éè¡¨ç¤ºãƒ»ç„¡åŠ¹åŒ–
            providerContactDurationGroup.style.display = 'none';
            datasetProviderGroup.style.display = 'none'; // ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæä¾›è€…å/ä¼šç¤¾åã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’éè¡¨ç¤º
            contactInfoGroup.style.display = 'none';
            contractDurationGroup.style.display = 'none';
            datasetProviderInput.disabled = true;
            contactInfoInput.disabled = true;
            contractStartDateInput.disabled = true;
            contractEndDateInput.disabled = true;
            noContractDurationCheckbox.disabled = true;


            // æ¨©é™ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ã™ã¹ã¦ç„¡åŠ¹åŒ–
            aiTrainingPermissionSelect.disabled = true;
            requireAIAttributionCheckbox.disabled = true;
            allowCommercialUseCheckbox.disabled = true;
            allowRedistributionCheckbox.disabled = true;
            allowModificationCheckbox.disabled = true;
            allowNonCommercialUseOnlyCheckbox.disabled = true;
            requireServiceCreditCheckbox.disabled = true;
            prohibitReligiousPoliticalCheckbox.disabled = true;
            prohibitEroticGrotesqueCheckbox.disabled = true;
            prohibitThirdPartyReproductionCheckbox.disabled = true;


            if (selectedTemplate === 'none') {
                // ä½•ã‚‚ã—ãªã„
            } else if (selectedTemplate === 'custom') {
                licenseContentTextarea.disabled = false;
                licenseFileNameInput.value = 'LICENSE.txt';
                
                // ã‚«ã‚¹ã‚¿ãƒ ã®å ´åˆã€ã™ã¹ã¦ã®å…¥åŠ›æ¬„ã‚’éè¡¨ç¤º
                providerContactDurationGroup.style.display = 'none'; // è¦ªã‚°ãƒ«ãƒ¼ãƒ—ã‚’éè¡¨ç¤º
                datasetProviderGroup.style.display = 'none'; // ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæä¾›è€…å/ä¼šç¤¾åã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’éè¡¨ç¤º
                contactInfoGroup.style.display = 'none'; // é€£çµ¡å…ˆã¯éè¡¨ç¤º
                contractDurationGroup.style.display = 'none'; // å¥‘ç´„æœŸé–“ã¯éè¡¨ç¤º
                datasetProviderInput.disabled = true;
                contactInfoInput.disabled = true;
                contractStartDateInput.disabled = true;
                contractEndDateInput.disabled = true;
                noContractDurationCheckbox.disabled = true;

            } else if (selectedTemplate === 'default_paid') {
                licenseContentTextarea.disabled = false;
                licenseFileNameInput.value = 'LICENSE.txt';
                permissionOptionsDiv.style.display = 'flex';
                
                // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœ‰æ–™ã®å ´åˆã€æä¾›è€…åã€é€£çµ¡å…ˆã€å¥‘ç´„æœŸé–“ã®å…¨ã¦ã‚’è¡¨ç¤ºãƒ»æœ‰åŠ¹åŒ–
                providerContactDurationGroup.style.display = 'block';
                datasetProviderGroup.style.display = 'flex'; // ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæä¾›è€…å/ä¼šç¤¾åã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¡¨ç¤º
                contactInfoGroup.style.display = 'flex';
                contractDurationGroup.style.display = 'flex';
                datasetProviderInput.disabled = false;
                contactInfoInput.disabled = false;
                contractStartDateInput.disabled = noContractDurationCheckbox.checked;
                contractEndDateInput.disabled = noContractDurationCheckbox.checked;
                noContractDurationCheckbox.disabled = false;

                // æ¨©é™ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’æœ‰åŠ¹åŒ–
                aiTrainingPermissionSelect.disabled = false;
                requireAIAttributionCheckbox.disabled = false; // å¸¸ã«æœ‰åŠ¹åŒ–
                allowCommercialUseCheckbox.disabled = false;
                allowRedistributionCheckbox.disabled = false;
                allowModificationCheckbox.disabled = false;
                allowNonCommercialUseOnlyCheckbox.disabled = false; // aiTrainingPermissionSelect ã®å€¤ã«ä¾å­˜
                requireServiceCreditCheckbox.disabled = false;
                prohibitReligiousPoliticalCheckbox.disabled = false;
                prohibitEroticGrotesqueCheckbox.disabled = false;
                prohibitThirdPartyReproductionCheckbox.disabled = false;

                // aiTrainingPermissionSelect ã®ç¾åœ¨ã®å€¤ã«åŸºã¥ã„ã¦ allowNonCommercialUseOnlyCheckbox ã‚’åˆ¶å¾¡
                const currentAITrainingOption = aiTrainingPermissionSelect.value;
                if (currentAITrainingOption === 'ai_minor_use') {
                    allowNonCommercialUseOnlyCheckbox.checked = false;
                    allowNonCommercialUseOnlyCheckbox.disabled = true;
                } else {
                    allowNonCommercialUseOnlyCheckbox.disabled = false;
                }

            } else if (selectedTemplate === 'default_free') {
                licenseContentTextarea.disabled = false;
                licenseFileNameInput.value = 'LICENSE.txt';
                freeLicenseOptionsDiv.style.display = 'flex';
                
                // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç„¡æ–™ã®å ´åˆã€æä¾›è€…åã®ã¿è¡¨ç¤ºãƒ»æœ‰åŠ¹åŒ–
                providerContactDurationGroup.style.display = 'block';
                datasetProviderGroup.style.display = 'flex'; // ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæä¾›è€…å/ä¼šç¤¾åã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’è¡¨ç¤º
                datasetProviderInput.disabled = false;
                contactInfoGroup.style.display = 'none'; // é€£çµ¡å…ˆã¯éè¡¨ç¤º
                contractDurationGroup.style.display = 'none'; // å¥‘ç´„æœŸé–“ã¯éè¡¨ç¤º
                contactInfoInput.disabled = true;
                contractStartDateInput.disabled = true;
                contractEndDateInput.disabled = true;
                noContractDurationCheckbox.disabled = true;

                // ç„¡æ–™ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®å ´åˆã€æ¨©é™ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã¯ç„¡åŠ¹åŒ–
                aiTrainingPermissionSelect.disabled = true;
                requireAIAttributionCheckbox.disabled = true;
                allowCommercialUseCheckbox.disabled = true;
                allowRedistributionCheckbox.disabled = true;
                allowModificationCheckbox.disabled = true;
                allowNonCommercialUseOnlyCheckbox.disabled = true;
                requireServiceCreditCheckbox.disabled = true;
                prohibitReligiousPoliticalCheckbox.disabled = true;
                prohibitEroticGrotesqueCheckbox.disabled = true;
                prohibitThirdPartyReproductionCheckbox.disabled = true;

                // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚’é¸æŠ
                freeLicenseSelect.value = 'mit_license';
            }
            updateLicenseContent(); // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å†…å®¹ã‚’æ›´æ–°
            updateZipContentPreview(); // ZIPå†…å®¹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°
        });

        // ç„¡æ–™ãƒ©ã‚¤ã‚»ãƒ³ã‚¹é¸æŠã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        freeLicenseSelect.addEventListener('change', () => {
            updateLicenseContent();
            updateZipContentPreview();
        });


        // ç”ŸæˆAIå­¦ç¿’è¨±å¯ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        aiTrainingPermissionSelect.addEventListener('change', () => {
            const selectedOption = aiTrainingPermissionSelect.value;
            // ã€Œè»½å¾®åˆ©ç”¨ã€ãŒé¸æŠã•ã‚ŒãŸå ´åˆã€ã€Œéäº«å—åˆ©ç”¨ä»¥å¤–ã®åˆ©ç”¨ã‚’ç¦æ­¢ã™ã‚‹ã€ã‚’ç„¡åŠ¹åŒ–ã—ã€ãƒã‚§ãƒƒã‚¯ã‚’å¤–ã™
            if (selectedOption === 'ai_minor_use') {
                allowNonCommercialUseOnlyCheckbox.checked = false;
                allowNonCommercialUseOnlyCheckbox.disabled = true;
            } else {
                // å•†ç”¨åˆ©ç”¨ãŒè¨±å¯ã•ã‚Œã¦ã„ãªã„å ´åˆã®ã¿æœ‰åŠ¹åŒ–
                if (!allowCommercialUseCheckbox.checked) {
                    allowNonCommercialUseOnlyCheckbox.disabled = false;
                }
            }
            // requireAIAttributionCheckbox ã¯å¸¸ã«æœ‰åŠ¹ãªã®ã§ã€ã“ã“ã§ã¯åˆ¶å¾¡ã—ãªã„
            updateLicenseContent();
            updateZipContentPreview();
        });


        // æ¨©é™ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        requireAIAttributionCheckbox.addEventListener('change', () => { updateLicenseContent(); updateZipContentPreview(); });
        allowCommercialUseCheckbox.addEventListener('change', () => {
            // å•†ç”¨åˆ©ç”¨ã‚’è¨±å¯ã™ã‚‹å ´åˆã€éäº«å—åˆ©ç”¨ã®ã¿ã‚’è¨±å¯ã™ã‚‹ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã¯ç„¡åŠ¹åŒ–
            if (allowNonCommercialUseOnlyCheckbox.checked) { // éäº«å—åˆ©ç”¨ã®ã¿ãŒãƒã‚§ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€å•†ç”¨åˆ©ç”¨ã‚’ç„¡åŠ¹åŒ–
                allowCommercialUseCheckbox.checked = false;
                allowCommercialUseCheckbox.disabled = true;
            } else {
                allowCommercialUseCheckbox.disabled = false;
            }
            updateLicenseContent(); updateZipContentPreview();
        });
        allowRedistributionCheckbox.addEventListener('change', () => { updateLicenseContent(); updateZipContentPreview(); });
        allowModificationCheckbox.addEventListener('change', () => { updateLicenseContent(); updateZipContentPreview(); });

        // æ–°ã—ã„åˆ©ç”¨è¨±è«¾å†…å®¹ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        allowNonCommercialUseOnlyCheckbox.addEventListener('change', () => {
            // éäº«å—åˆ©ç”¨ã®ã¿ã‚’è¨±å¯ã™ã‚‹å ´åˆã€å•†ç”¨åˆ©ç”¨ã‚’è¨±å¯ã™ã‚‹ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã¯ç„¡åŠ¹åŒ–
            if (allowNonCommercialUseOnlyCheckbox.checked) {
                allowCommercialUseCheckbox.checked = false;
                allowCommercialUseCheckbox.disabled = true;
            } else {
                allowCommercialUseCheckbox.disabled = false;
            }
            updateLicenseContent(); updateZipContentPreview();
        });
        requireServiceCreditCheckbox.addEventListener('change', () => { updateLicenseContent(); updateZipContentPreview(); });
        prohibitReligiousPoliticalCheckbox.addEventListener('change', () => { updateLicenseContent(); updateZipContentPreview(); });
        prohibitEroticGrotesqueCheckbox.addEventListener('change', () => { updateLicenseContent(); updateZipContentPreview(); });
        prohibitThirdPartyReproductionCheckbox.addEventListener('change', () => { updateLicenseContent(); updateZipContentPreview(); });


        // å¥‘ç´„æœŸé–“è¨­å®šé–¢é€£ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        contractStartDateInput.addEventListener('input', () => { updateLicenseContent(); updateZipContentPreview(); });
        contractEndDateInput.addEventListener('input', () => { updateLicenseContent(); updateZipContentPreview(); });
        noContractDurationCheckbox.addEventListener('change', () => {
            const isDisabled = noContractDurationCheckbox.checked;
            contractStartDateInput.disabled = isDisabled;
            contractEndDateInput.disabled = isDisabled;
            if (isDisabled) {
                contractStartDateInput.value = ''; // æœŸé–“ãªã—ã®å ´åˆã€æ—¥ä»˜ã‚’ã‚¯ãƒªã‚¢
                contractEndDateInput.value = '';
            }
            updateLicenseContent();
            updateZipContentPreview();
        });

        // ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæä¾›è€…ã€é€£çµ¡å…ˆæƒ…å ±ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        datasetProviderInput.addEventListener('input', () => { updateLicenseContent(); updateZipContentPreview(); });
        contactInfoInput.addEventListener('input', () => { updateLicenseContent(); updateZipContentPreview(); });


        // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å†…å®¹ã‚’ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«åæ˜ ã™ã‚‹é–¢æ•°
        const updateLicenseContent = () => {
            licenseContentTextarea.value = generateLicenseContent();
        };


        // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«åå…¥åŠ›æ¬„ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        licenseFileNameInput.addEventListener('input', () => {
            updateZipContentPreview(); // ZIPå†…å®¹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°
        });

        // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å†…å®¹ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        licenseContentTextarea.addEventListener('input', () => {
            // ã‚«ã‚¹ã‚¿ãƒ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®å ´åˆã®ã¿ã€æ‰‹å‹•å…¥åŠ›ã•ã‚ŒãŸå†…å®¹ã‚’åæ˜ 
            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœ‰æ–™ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®å ´åˆã‚‚æ‰‹å‹•å…¥åŠ›ã•ã‚ŒãŸå†…å®¹ã‚’åæ˜ ã™ã‚‹ã‚ˆã†ã«å¤‰æ›´
            if (licenseTemplateSelect.value === 'custom' || licenseTemplateSelect.value === 'default_paid' || licenseTemplateSelect.value === 'default_free') {
                updateZipContentPreview(); // ZIPå†…å®¹ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°
            }
        });


        // æƒ…å ±è§£æãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã®ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ãã®å‡¦ç†
        formatCsvRadio.addEventListener('change', updateZipContentPreview);
        formatTxtRadio.addEventListener('change', updateZipContentPreview);


        // ZIPãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆï¼†ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã¨ãã®å‡¦ç†
        downloadZipBtn.addEventListener('click', async () => {
            if (selectedFiles.length === 0) {
                statusMessage.textContent = 'ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚';
                return;
            }

            downloadZipBtn.disabled = true; // ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–
            loadingSpinner.style.display = 'block'; // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ãƒ”ãƒŠãƒ¼ã‚’è¡¨ç¤º
            statusMessage.textContent = 'ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆä¸­ã§ã™...'; // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ›´æ–°

            const zip = new JSZip(); // æ–°ã—ã„JSZipã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ

            // å„ç”»åƒã‚’ZIPã«è¿½åŠ 
            for (const item of selectedFiles) {
                if (item.file.type.startsWith('image/')) {
                    const arrayBuffer = await item.file.arrayBuffer(); // ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ArrayBufferã¨ã—ã¦éåŒæœŸã§èª­ã¿è¾¼ã‚€
                    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæŒ‡å®šã—ãŸzipPathã‚’ä½¿ç”¨ã€‚ç©ºã®å ´åˆã¯originalFileNameã‚’ä½¿ç”¨
                    const pathInZip = item.zipPath || item.originalFileName;
                    // ãƒ‘ã‚¹åŒºåˆ‡ã‚Šæ–‡å­—ã‚’æ­£è¦åŒ–ï¼ˆWindowsã®\ã‚‚/ã«å¤‰æ›ï¼‰
                    const normalizedPath = pathInZip.replace(/\\/g, '/');
                    zip.file(normalizedPath, arrayBuffer); // æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¹ã§ZIPã«è¿½åŠ 
                }
            }

            // æƒ…å ±è§£æãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¦ZIPã«è¿½åŠ 
            const metadataContent = generateMetadataFileContent();
            const metadataFileName = getMetadataFileName();
            zip.file(metadataFileName, metadataContent);

            // ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¨­å®šã•ã‚Œã¦ã„ã‚Œã°ZIPã«è¿½åŠ 
            const licenseContent = generateLicenseContent(); // æœ€æ–°ã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å†…å®¹ã‚’å–å¾—
            const licenseFileName = licenseFileNameInput.value.trim();
            if (licenseContent && licenseFileName && licenseTemplateSelect.value !== 'none') {
                zip.file(licenseFileName, licenseContent);
            }

            // ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
            zip.generateAsync({ type: "blob" }) // Blobå½¢å¼ã§ZIPãƒ•ã‚¡ã‚¤ãƒ«ã‚’éåŒæœŸç”Ÿæˆ
                .then(function (content) {
                    saveAs(content, "ai_training_data.zip"); // FileSaver.jsã‚’ä½¿ã£ã¦ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                    statusMessage.textContent = 'ZIPãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸï¼';
                })
                .catch(error => {
                    statusMessage.textContent = 'ZIPãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message;
                    console.error('ZIP creation error:', error);
                })
                .finally(() => {
                    loadingSpinner.style.display = 'none'; // ã‚¹ãƒ”ãƒŠãƒ¼ã‚’éè¡¨ç¤º
                    downloadZipBtn.disabled = false; // ãƒœã‚¿ãƒ³ã‚’å†åº¦æœ‰åŠ¹åŒ–
                });
        });

        // åˆæœŸè¡¨ç¤ºæ™‚ã«ã™ã¹ã¦ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        renderAllPreviews();
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹é››å‹ã‚’é©ç”¨
        licenseTemplateSelect.dispatchEvent(new Event('change'));
    </script>
</body>
</html>
